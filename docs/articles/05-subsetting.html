<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='"Getting data for your AOI"
'>
<title>Building your own subset • hydrofabric</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Building your own subset">
<meta property="og:description" content='"Getting data for your AOI"
'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydrofabric</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/NOAA-OWP/hydrofabric/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="05-subsetting_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="05-subsetting_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="05-subsetting_files/leaflet-1.3.1/leaflet.js"></script><link href="05-subsetting_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="05-subsetting_files/proj4-2.6.2/proj4.min.js"></script><script src="05-subsetting_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="05-subsetting_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="05-subsetting_files/leaflet-binding-2.1.2/leaflet.js"></script><script src="05-subsetting_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="05-subsetting_files/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script><link href="05-subsetting_files/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="05-subsetting_files/HomeButton-0.0.1/home-button.js"></script><script src="05-subsetting_files/HomeButton-0.0.1/easy-button-src.min.js"></script><script src="05-subsetting_files/clipboard-0.0.1/setClipboardText.js"></script><link href="05-subsetting_files/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="05-subsetting_files/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Building your own subset</h1>
                        <h4 data-toc-skip class="author">Mike
Johnson</h4>
            <address class="author_afil">
      Lynker,
NOAA-Affiliate<br><h4 data-toc-skip class="author">Justin
Singh</h4>
            <address class="author_afil">
      Lynker, NOAA-Affiliate<br><small class="dont-index">Source: <a href="https://github.com/NOAA-OWP/hydrofabric/blob/HEAD/vignettes/05-subsetting.Rmd" class="external-link"><code>vignettes/05-subsetting.Rmd</code></a></small>
      <div class="d-none name"><code>05-subsetting.Rmd</code></div>
    </address>
</address>
</div>

    
    
<p>We are now at the point where we have a common understanding of how
hydrofabrics are sourced, manipulated for a given modeling task, and
generated on a VPU basis.</p>
<p>This aim of this section is that each of us can build a subset
network for a hydrolocation of interest. Doing this requires an
understanding of the following:</p>
<ol style="list-style-type: decimal">
<li>The CONUS network file</li>
<li>General topological sorts and pitfalls</li>
<li>The R based <code><a href="../reference/subset_network.html">hydrofabric::subset_network</a></code>
</li>
<li>The CLI, Go based, utility for micro service subsets.</li>
</ol>
<div class="section level2">
<h2 id="the-conus-network-file">The CONUS network file<a class="anchor" aria-label="anchor" href="#the-conus-network-file"></a>
</h2>
<ul>
<li><p>Remember, reference, refactor, and NextGen products are
distributed by VPU.</p></li>
<li><p>While the data products are segmented, they do describe a
holistic network.</p></li>
<li><p>To easy data discoverabilty, cross-walking, and indexing, the
network layers of each VPU are joined into a single Parquet file (~80MB
in size)</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net</span> <span class="op">=</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"../data/conus_net.parquet"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 3,178,347</span></span>
<span><span class="co">## Columns: 16</span></span>
<span><span class="co">## $ id                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "wb-282", "wb-282", "wb-282", "wb-282", "wb-2462…</span></span>
<span><span class="co">## $ toid                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "tnx-1000000171", "tnx-1000000171", "tnx-1000000…</span></span>
<span><span class="co">## $ divide_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cat-282", "cat-282", "cat-282", "cat-282", "cat…</span></span>
<span><span class="co">## $ ds_id                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</span></span>
<span><span class="co">## $ mainstem              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2238463, 2238463, 2238463, 2238463, 2243682, 224…</span></span>
<span><span class="co">## $ hl_id                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, "176", "176", "176", "183", "183…</span></span>
<span><span class="co">## $ hydroseq              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 19980, 19980, 19980, 19980, 19979, 19979, 19979,…</span></span>
<span><span class="co">## $ hl_uri                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, "HUC12-010100100101", "HUC12-010…</span></span>
<span><span class="co">## $ hf_source             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NHDPlusV2", "NHDPlusV2", "NHDPlusV2", "NHDPlusV…</span></span>
<span><span class="co">## $ hf_id                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4287171, 4287061, 4287169, 4287115, 816563, 8164…</span></span>
<span><span class="co">## $ lengthkm              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.695258, 3.695258, 3.695258, 3.695258, 5.135779…</span></span>
<span><span class="co">## $ areasqkm              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.786451, 6.786451, 6.786451, 6.786451, 13.28626…</span></span>
<span><span class="co">## $ tot_drainage_areasqkm <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.786451, 6.786451, 6.786451, 6.786451, 51.65776…</span></span>
<span><span class="co">## $ type                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "terminal", "terminal", "terminal", "terminal", …</span></span>
<span><span class="co">## $ vpu                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "01", "01", "01", "01", "01", "01", "01", "01", …</span></span>
<span><span class="co">## $ hf_hydroseq           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 150061851, 150030537, 150035911, 150045246, 1500…</span></span></code></pre>
<p>In the above table you’ll see that every relationship between the
features in the current hydrofabric, the source hydrofabric, and all
hydrolocations, have been exploded into a “many-to-many” table.</p>
<p>For example, we can look at the flowpath <code>wb-1002</code> and
find that it is defined by the aggregation of NHDPlusV2 COMID 2239831
and 2239831.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">id</span> <span class="op">==</span> <span class="st">"wb-1002"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 2</span></span>
<span><span class="co">## Columns: 16</span></span>
<span><span class="co">## $ id                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "wb-1002", "wb-1002"</span></span>
<span><span class="co">## $ toid                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "nex-294", "nex-294"</span></span>
<span><span class="co">## $ divide_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cat-1002", "cat-1002"</span></span>
<span><span class="co">## $ ds_id                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA</span></span>
<span><span class="co">## $ mainstem              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2239831, 2239831</span></span>
<span><span class="co">## $ hl_id                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA</span></span>
<span><span class="co">## $ hydroseq              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1927, 1927</span></span>
<span><span class="co">## $ hl_uri                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA</span></span>
<span><span class="co">## $ hf_source             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NHDPlusV2", "NHDPlusV2"</span></span>
<span><span class="co">## $ hf_id                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4290271, 4290437</span></span>
<span><span class="co">## $ lengthkm              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.291308, 6.291308</span></span>
<span><span class="co">## $ areasqkm              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 23.06835, 23.06835</span></span>
<span><span class="co">## $ tot_drainage_areasqkm <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 54.84601, 54.84601</span></span>
<span><span class="co">## $ type                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "nexus", "nexus"</span></span>
<span><span class="co">## $ vpu                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "01", "01"</span></span>
<span><span class="co">## $ hf_hydroseq           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 150045065, 150035814</span></span></code></pre>
<p>Or, that the terminal outflow of ‘HUC12-010100100101’ occurs at
<code>tnx-1000000019</code> which is fed by an aggregate flowpath made
up of three source flowpaths
(<code>COMID={816563, 816417, 816415}</code>)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hl_uri</span> <span class="op">==</span> <span class="st">'HUC12-010100100101'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 3</span></span>
<span><span class="co">## Columns: 16</span></span>
<span><span class="co">## $ id                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "wb-2462", "wb-2462", "wb-2462"</span></span>
<span><span class="co">## $ toid                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "tnx-1000000019", "tnx-1000000019", "tnx-1000000…</span></span>
<span><span class="co">## $ divide_id             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "cat-2462", "cat-2462", "cat-2462"</span></span>
<span><span class="co">## $ ds_id                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA</span></span>
<span><span class="co">## $ mainstem              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2243682, 2243682, 2243682</span></span>
<span><span class="co">## $ hl_id                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "176", "176", "176"</span></span>
<span><span class="co">## $ hydroseq              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 19979, 19979, 19979</span></span>
<span><span class="co">## $ hl_uri                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "HUC12-010100100101", "HUC12-010100100101", "HUC…</span></span>
<span><span class="co">## $ hf_source             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NHDPlusV2", "NHDPlusV2", "NHDPlusV2"</span></span>
<span><span class="co">## $ hf_id                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 816563, 816417, 816415</span></span>
<span><span class="co">## $ lengthkm              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.135779, 5.135779, 5.135779</span></span>
<span><span class="co">## $ areasqkm              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.28626, 13.28626, 13.28626</span></span>
<span><span class="co">## $ tot_drainage_areasqkm <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 51.65776, 51.65776, 51.65776</span></span>
<span><span class="co">## $ type                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "terminal", "terminal", "terminal"</span></span>
<span><span class="co">## $ vpu                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "01", "01", "01"</span></span>
<span><span class="co">## $ hf_hydroseq           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 150027523, 150024646, 150066278</span></span></code></pre>
<div class="section level3">
<h3 id="why-do-it-this-way">Why do it this way?<a class="anchor" aria-label="anchor" href="#why-do-it-this-way"></a>
</h3>
<div class="section level4">
<h4 id="speed">1. Speed<a class="anchor" aria-label="anchor" href="#speed"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">net</span> <span class="op">=</span> <span class="fu">read_parquet</span><span class="op">(</span><span class="st">'s3://nextgen-hydrofabric/pre-release/conus_net.parquet'</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#    user  system elapsed </span></span>
<span><span class="co">#  2.180   2.123  41.288 </span></span></code></pre></div>
<div class="section level5">
<h5 id="defered-evaluation">Defered Evaluation<a class="anchor" aria-label="anchor" href="#defered-evaluation"></a>
</h5>
<p>The times you would want to open the entire network are limited,
often, we are interested in small bits of data that</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">net</span> <span class="op">=</span> <span class="fu">open_dataset</span><span class="op">(</span><span class="st">'s3://nextgen-hydrofabric/pre-release/conus_net.parquet'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="st">"wb-1002"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   user  system elapsed </span></span>
<span><span class="co">#  2.294   2.588  24.261</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="feature-identification">2. Feature Identification<a class="anchor" aria-label="anchor" href="#feature-identification"></a>
</h4>
<div class="section level5">
<h5 id="by-location">By location<a class="anchor" aria-label="anchor" href="#by-location"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">here</span> <span class="op">=</span> <span class="fu">AOI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AOI/man/geocode.html" class="external-link">geocode</a></span><span class="op">(</span><span class="st">"National Water Center, Alabama"</span>, pt <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu">dataRetrieval</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/findNLDI.html" class="external-link">findNLDI</a></span><span class="op">(</span>location <span class="op">=</span> <span class="va">here</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hf_id</span> <span class="op">==</span> <span class="va">x</span><span class="op">$</span><span class="va">origin</span><span class="op">$</span><span class="va">comid</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 16</span></span></span>
<span><span class="co">##   id       toid  divide_id ds_id mainstem hl_id hydroseq hl_uri hf_source  hf_id</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> wb-1649… nex-… cat-1649…    <span style="color: #BB0000;">NA</span>  1<span style="text-decoration: underline;">717</span>455 <span style="color: #BB0000;">NA</span>        <span style="text-decoration: underline;">4</span>370 <span style="color: #BB0000;">NA</span>     NHDPlusV2 1.58<span style="color: #949494;">e</span>7</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: lengthkm &lt;dbl&gt;, areasqkm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   tot_drainage_areasqkm &lt;dbl&gt;, type &lt;chr&gt;, vpu &lt;chr&gt;, hf_hydroseq &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level5">
<h5 id="for-a-gage-in-calfornia">For a gage in Calfornia<a class="anchor" aria-label="anchor" href="#for-a-gage-in-calfornia"></a>
</h5>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hl_uri</span> <span class="op">==</span> <span class="st">"Gages-11123000"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="fu">slice_max</span><span class="op">(</span><span class="va">hl</span>, <span class="va">hf_hydroseq</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 16</span></span></span>
<span><span class="co">##   id       toid  divide_id ds_id mainstem hl_id hydroseq hl_uri hf_source  hf_id</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> wb-3400… nex-… cat-3400…    <span style="color: #BB0000;">NA</span>  1<span style="text-decoration: underline;">839</span>328 3569     <span style="text-decoration: underline;">30</span>250 Gages… NHDPlusV2 1.76<span style="color: #949494;">e</span>7</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: lengthkm &lt;dbl&gt;, areasqkm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   tot_drainage_areasqkm &lt;dbl&gt;, type &lt;chr&gt;, vpu &lt;chr&gt;, hf_hydroseq &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level5">
<h5 id="for-the-huc12-of-atascadero-creek-in-santa-barbara">For the HUC12 of Atascadero Creek in Santa Barbara:<a class="anchor" aria-label="anchor" href="#for-the-huc12-of-atascadero-creek-in-santa-barbara"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hl_uri</span> <span class="op">==</span> <span class="st">"HUC12-180600130201"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">wbd</span> <span class="op">=</span> <span class="fu">slice_max</span><span class="op">(</span><span class="va">hl</span>, <span class="va">hf_hydroseq</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 16</span></span></span>
<span><span class="co">##   id       toid  divide_id ds_id mainstem hl_id hydroseq hl_uri hf_source  hf_id</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> wb-3400… nex-… cat-3400…    <span style="color: #BB0000;">NA</span>  1<span style="text-decoration: underline;">841</span>917 2281     <span style="text-decoration: underline;">16</span>722 HUC12… NHDPlusV2 1.76<span style="color: #949494;">e</span>7</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: lengthkm &lt;dbl&gt;, areasqkm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   tot_drainage_areasqkm &lt;dbl&gt;, type &lt;chr&gt;, vpu &lt;chr&gt;, hf_hydroseq &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level5">
<h5 id="for-the-dam-on-horsetooth-reservoir">For the dam on Horsetooth Reservoir<a class="anchor" aria-label="anchor" href="#for-the-dam-on-horsetooth-reservoir"></a>
</h5>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hl_uri</span> <span class="op">==</span> <span class="st">"NID-CO01659-1"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">wbd</span> <span class="op">=</span> <span class="fu">slice_max</span><span class="op">(</span><span class="va">hl</span>, <span class="va">hf_hydroseq</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 16</span></span></span>
<span><span class="co">##   id       toid  divide_id ds_id mainstem hl_id hydroseq hl_uri hf_source  hf_id</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> wb-3314… nex-… cat-3314…    <span style="color: #BB0000;">NA</span>  1<span style="text-decoration: underline;">223</span>227 7253     <span style="text-decoration: underline;">11</span>610 NID-C… NHDPlusV2 2.90<span style="color: #949494;">e</span>6</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: lengthkm &lt;dbl&gt;, areasqkm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   tot_drainage_areasqkm &lt;dbl&gt;, type &lt;chr&gt;, vpu &lt;chr&gt;, hf_hydroseq &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level5">
<h5 id="by-known-comid">By known COMID<a class="anchor" aria-label="anchor" href="#by-known-comid"></a>
</h5>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hf_id</span> <span class="op">==</span> <span class="fl">101</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 16</span></span></span>
<span><span class="co">##   id        toid  divide_id ds_id mainstem hl_id hydroseq hl_uri hf_source hf_id</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> wb-26052… nex-… cat-2605…    <span style="color: #BB0000;">NA</span>  2<span style="text-decoration: underline;">603</span>469 281        120 HUC12… NHDPlusV2   101</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 6 more variables: lengthkm &lt;dbl&gt;, areasqkm &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   tot_drainage_areasqkm &lt;dbl&gt;, type &lt;chr&gt;, vpu &lt;chr&gt;, hf_hydroseq &lt;dbl&gt;</span></span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="topo-sorting">3. Topo sorting!<a class="anchor" aria-label="anchor" href="#topo-sorting"></a>
</h4>
<p>A national network provides an opportunity for rapid network
navigation and subsetting. The structure of the CONUS network file also
facilitates this, if a few precautions are taken.</p>
<p>While the “many-to-many” relationship of the network file allows for
fast indexing and discovery, the duplication of feature IDs is not
conducive to graph based approaches.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Most downstream feature associated with </span></span>
<span><span class="op">(</span><span class="va">wbd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hl_uri</span> <span class="op">==</span> <span class="st">"HUC12-180600130201"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">toid</span>, <span class="va">hl_uri</span>, <span class="va">vpu</span>, <span class="va">hydroseq</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">slice_max</span><span class="op">(</span><span class="va">hydroseq</span>, with_ties <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">##   id         toid        hl_uri             vpu   hydroseq</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span> wb-3400759 nex-3400758 HUC12-180600130201 18       <span style="text-decoration: underline;">16</span>731</span></span></code></pre>
<p>Seeking just the topology of the network would be
impractical/wrong</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">vpu</span> <span class="op">==</span> <span class="va">wbd</span><span class="op">$</span><span class="va">vpu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">toid</span>, <span class="va">divide_id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 170,349 × 3</span></span></span>
<span><span class="co">##    id         toid           divide_id  </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 170,339 more rows</span></span></span></code></pre>
<p>Thus, you NEED to make sure that operations running on the network
file are dealing with distinct rows for the operations you want.</p>
<p>In the case of hydrosequencing, these are unique
<code>id</code>/<code>toid</code> pairs</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">wbd_net</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">vpu</span> <span class="op">==</span> <span class="va">wbd</span><span class="op">$</span><span class="va">vpu</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">toid</span>, <span class="va">divide_id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: There was 1 warning in `filter()`.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> In argument: `vpu == wbd$vpu`.</span></span>
<span><span class="co">## Caused by warning in `vpu == wbd$vpu`:</span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> longer object length is not a multiple of shorter object length</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 65,280 × 3</span></span></span>
<span><span class="co">##    id         toid           divide_id  </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> wb-3378885 tnx-1000012409 cat-3378885</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> wb-3378890 tnx-1000013027 cat-3378890</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> wb-3378892 tnx-1000012410 cat-3378892</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> wb-3378895 tnx-1000013028 cat-3378895</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> wb-3378974 tnx-1000013029 cat-3378974</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> wb-3380350 tnx-1000012411 cat-3380350</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> wb-3380601 tnx-1000012412 cat-3380601</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> wb-3380616 tnx-1000012414 cat-3380616</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> wb-3380617 tnx-1000013030 cat-3380617</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> wb-3380618 tnx-1000012415 cat-3380618</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 65,270 more rows</span></span></span></code></pre>
<p>With a complete, non duplicated network, we can easily sort and
subset based on a defined outlet(s)</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu">get_sorted</span><span class="op">(</span><span class="va">wbd_net</span>, outlets <span class="op">=</span> <span class="va">wbd</span><span class="op">$</span><span class="va">toid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in check_hy_outlets(x, fix = FALSE): Outlets don't follow hydroloom</span></span>
<span><span class="co">## convention of 0 or '', not fixing.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 20 × 3</span></span></span>
<span><span class="co">##    id          toid        divide_id  </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> wb-3400765  nex-3400757 cat-3400765</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> nex-3400757 wb-3400757  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> wb-3400757  nex-3400758 cat-3400757</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> wb-3400769  nex-3400759 cat-3400769</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> nex-3400759 wb-3400759  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> wb-3400759  nex-3400758 cat-3400759</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> wb-3400760  nex-3400761 cat-3400760</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> nex-3400761 wb-3400761  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> wb-3400761  nex-3400758 cat-3400761</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> wb-3400768  nex-3400758 cat-3400768</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> wb-3400766  nex-3400762 cat-3400766</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> nex-3400762 wb-3400762  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> wb-3400762  nex-3400763 cat-3400762</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> wb-3400767  nex-3400764 cat-3400767</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> nex-3400764 wb-3400764  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> wb-3400764  nex-3400763 cat-3400764</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> wb-3400770  nex-3400763 cat-3400770</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span> nex-3400763 wb-3400763  <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span> wb-3400763  nex-3400758 cat-3400763</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">20</span> nex-3400758 wb-3400758  <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="complete-example">Complete Example:<a class="anchor" aria-label="anchor" href="#complete-example"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">wbd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">hl_uri</span> <span class="op">==</span> <span class="st">"HUC12-180600130201"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">select</span><span class="op">(</span><span class="va">toid</span>,  <span class="va">vpu</span>, <span class="va">hydroseq</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>   <span class="fu">slice_max</span><span class="op">(</span><span class="va">hydroseq</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">wbd_net</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">net</span>, <span class="va">vpu</span> <span class="op">==</span> <span class="va">wbd</span><span class="op">$</span><span class="va">vpu</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">toid</span>, <span class="va">divide_id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">get_sorted</span><span class="op">(</span>outlets <span class="op">=</span> <span class="va">wbd</span><span class="op">$</span><span class="va">toid</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in check_hy_outlets(x, fix = FALSE): Outlets don't follow hydroloom</span></span>
<span><span class="co">## convention of 0 or '', not fixing.</span></span></code></pre>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   0.820   0.117   0.952</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ids</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">wbd_net</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "wb-3400765"  "nex-3400757" "wb-3400757"  "wb-3400769"  "nex-3400759"</span></span>
<span><span class="co">##  [6] "wb-3400759"  "wb-3400760"  "nex-3400761" "wb-3400761"  "wb-3400768" </span></span>
<span><span class="co">## [11] "wb-3400766"  "nex-3400762" "wb-3400762"  "wb-3400767"  "nex-3400764"</span></span>
<span><span class="co">## [16] "wb-3400764"  "wb-3400770"  "nex-3400763" "wb-3400763"  "nex-3400758"</span></span>
<span><span class="co">## [21] "wb-3400758"  "cat-3400765" "cat-3400757" "cat-3400769" "cat-3400759"</span></span>
<span><span class="co">## [26] "cat-3400760" "cat-3400761" "cat-3400768" "cat-3400766" "cat-3400762"</span></span>
<span><span class="co">## [31] "cat-3400767" "cat-3400764" "cat-3400770" "cat-3400763"</span></span>
<span><span class="co">## attr(,"na.action")</span></span>
<span><span class="co">## [1] 23</span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "omit"</span></span></code></pre>
<div class="section level4">
<h4 id="easy-integration-with-sql">4. Easy integration with SQL<a class="anchor" aria-label="anchor" href="#easy-integration-with-sql"></a>
</h4>
<p>Once you have a set of IDs, the SQL backing of GPKG allows for
quickly extracting features based on that ID set</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## USE GET HYDROFABRIC HERE</span></span>
<span><span class="op">(</span><span class="va">gpkg</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_fabric.html">get_fabric</a></span><span class="op">(</span>VPU <span class="op">=</span> <span class="va">wbd</span><span class="op">$</span><span class="va">vpu</span>,  cache_dir <span class="op">=</span> <span class="st">"cihro-data"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## cihro-data/nextgen_18.gpkg</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">SQLite</span><span class="op">(</span><span class="op">)</span>, <span class="va">gpkg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">=</span> <span class="fu">tbl</span><span class="op">(</span><span class="va">db</span>, <span class="st">"divides"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">if_any</span><span class="op">(</span><span class="fu">any_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'divide_id'</span>, <span class="st">'id'</span>, <span class="st">'ds_id'</span><span class="op">)</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ids</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">st_as_sf</span><span class="op">(</span><span class="va">t</span>, crs <span class="op">=</span> <span class="fl">5070</span><span class="op">)</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mapview</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5299b7c8b1dcfe4eb91d" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-5299b7c8b1dcfe4eb91d">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-119.8259698018833,-119.8240731948911,-119.8234358018784,-119.8223319024754,-119.8209092983338,-119.8193234022452,-119.8194865984885,-119.8173524008228,-119.8167149018791,-119.815847904418,-119.8144989976902,-119.8125124039352,-119.8080497014035,-119.8078125001873,-119.8078050026078,-119.8095468990401,-119.8099397014771,-119.811214705801,-119.812015302085,-119.8132902990473,-119.8147948999693,-119.8178775992777,-119.8184335022975,-119.818344197495,-119.817609901795,-119.8189585977797,-119.8208707972831,-119.8213526985205,-119.8235835017674,-119.824768900694,-119.8248427984281,-119.8257988019095,-119.8265099975326,-119.8282588003588,-119.8283325973729,-119.8295255966739,-119.8304815975075,-119.8316009004353,-119.8323198033091,-119.8329570959987,-119.8334470001868,-119.8339289007428,-119.8358409014798,-119.8396808033612,-119.8401706994324,-119.8408897039107,-119.8420988031545,-119.8405950000354,-119.8402842999805,-119.8406110006691,-119.8397445973858,-119.8408063045954,-119.8415253988181,-119.8421708008538,-119.8422524968411,-119.8422605024601,-119.8427506992609,-119.8422766031327,-119.8426849981409,-119.8441232981427,-119.8443684020503,-119.8463706001829,-119.8467792018534,-119.8474984041786,-119.8487241015858,-119.8494432990874,-119.849851903806,-119.8510534047857,-119.8520097003802,-119.8532928970144,-119.8546497017749,-119.8554508047459,-119.8570856967384,-119.8563745960327,-119.8563827961659,-119.8556799009062,-119.8548052027081,-119.8552956964816,-119.8549115048903,-119.8519603011204,-119.8519685030297,-119.8500635986251,-119.8498346000758,-119.8491969032291,-119.8492049974372,-119.8496874047804,-119.851240601121,-119.8506845992135,-119.8512486957659,-119.8504636972649,-119.8491962963622,-119.84920440371,-119.8470538967092,-119.8474625998383,-119.8477239984956,-119.8491712995484,-119.8494246999391,-119.8487213017609,-119.8484266966037,-119.8490726979899,-119.8501114039819,-119.8510764011425,-119.8517305985314,-119.8509372991377,-119.8513380026877,-119.8522294980916,-119.8497594011504,-119.8474447042191,-119.846324203236,-119.8456701006773,-119.8443043958364,-119.8424722952284,-119.8386444028323,-119.8373604953698,-119.8344896998816,-119.8336144027161,-119.8321750051178,-119.8310546016911,-119.8304904953801,-119.8292883997755,-119.8278489963119,-119.8266470031082,-119.8255266032083,-119.824561897044,-119.8236634008122,-119.8237295033682,-119.822994401367,-119.8244997982833,-119.8254565993583,-119.8264057040583,-119.8273624953874,-119.8285487000342,-119.8278136014778,-119.8275606983558,-119.8285096032625,-119.8288207017067,-119.8295324025166,-119.8320756954314,-119.8336701046247,-119.835011498186,-119.8368430994549,-119.8373174036044,-119.8389934972287,-119.8394678011033,-119.8407431969547,-119.8411357975525,-119.8417734960145,-119.8427139967158,-119.8427059987281,-119.8431802970943,-119.842608298022,-119.8412431982206,-119.8405895956536,-119.8413008995474,-119.8410558030532,-119.8412031971081,-119.8423150013288,-119.8418247990127,-119.8411055026356,-119.8398800991411,-119.8386786968511,-119.8376328008763,-119.8368976994035,-119.8362522024888,-119.8368080994613,-119.8350930011255,-119.8349217955357,-119.8341209988313,-119.8326748991908,-119.8315554004074,-119.8309179963904,-119.8302883968972,-119.8290213024398,-119.8274274960797,-119.8263974976034,-119.825122499315,-119.8250486052253,-119.8214915013784,-119.8208540018466,-119.8202241014225,-119.8187933998417,-119.8181404972157,-119.818696402824,-119.8185255013865,-119.8197113043916,-119.8194665043493,-119.8211264978285,-119.8202364013058,-119.8210293944704,-119.8210217015363,-119.8215775978596,-119.8212512037261,-119.8232297041127,-119.8233852033907,-119.8250603009815,-119.8277498967146,-119.8285349033279,-119.8283716998111,-119.8293198969771,-119.8291567008964,-119.8302602981149,-119.8298520988114,-119.8288961019337,-119.8265255995537,-119.8259698018833],"lat":[34.42528610012504,34.42789789775298,34.42803100227203,34.42992319815421,34.43188199793501,34.43332090236119,34.43384079749269,34.43677880080526,34.4369118965753,34.43847759842219,34.43959000344571,34.44083550315078,34.44176670072316,34.44209320370257,34.44098700197874,34.43896189978951,34.4380490998516,34.43778300285349,34.43816979768673,34.43790370340687,34.43620490031654,34.43196110285961,34.4315680968765,34.43020200077927,34.42786279592889,34.42675029864022,34.42635099847006,34.4268043014121,34.42633839718682,34.42470609604721,34.42385980124907,34.42366009955231,34.42268070020698,34.42176149800731,34.42091520229241,34.42038900048951,34.42018919880466,34.42050929662295,34.4206361016547,34.42050290261517,34.42206230376929,34.42251560012433,34.42211599775585,34.42352930044288,34.42508870181777,34.42521540232672,34.42690149938338,34.42860060282884,34.42977339829413,34.43081300061266,34.4323788988251,34.43575760250587,34.43588419996917,34.43685719804876,34.43711710412683,34.43822329671313,34.43978270292422,34.44043570064171,34.44173509758138,34.44198849741548,34.44276820271642,34.44373449802319,34.44503400002061,34.44516059825639,34.4490589988592,34.44918560229686,34.45048500178914,34.45106480223539,34.45086490337925,34.45170449952679,34.45169789784962,34.45208439905579,34.45728199850851,34.45826149830626,34.45936769813258,34.46145339611231,34.46191319709932,34.46347249678243,34.46549150154497,34.4658313999963,34.46693750235315,34.46844340267387,34.4698761016645,34.47000929966188,34.47111550265762,34.4715686022518,34.47650630154421,34.47689939848794,34.47761240260611,34.47943820300892,34.48081080356342,34.48191699867073,34.48264319805482,34.4839425971961,34.48693439714036,34.48829380113485,34.4901796000309,34.49226519823304,34.49565009705668,34.49662300375434,34.49668300238756,34.49758929688686,34.49966820115185,34.50038780394264,34.50058109671208,34.50233350000507,34.50312639959369,34.50333290099673,34.50301299722817,34.50093400039938,34.49983439992302,34.50049399827418,34.50129309872489,34.50045339901256,34.50105259894195,34.50151230026382,34.50125880182978,34.50093869986296,34.50022569722204,34.4996456979108,34.49939219851823,34.49881219843714,34.49849209544253,34.49758569787834,34.49472689808398,34.49277450076274,34.49043550028489,34.48873670182007,34.48853710179861,34.48723130296369,34.48703160100865,34.48539930144933,34.48306030346517,34.48117450307861,34.47986869990243,34.47869599947423,34.47771660261012,34.47607789926575,34.47574499857343,34.47352629641845,34.47286690389432,34.4722139020644,34.47214080432988,34.47148789656303,34.47122149877828,34.47030860225635,34.47017540161387,34.46776329923158,34.4666571988834,34.46600420134623,34.46418500062983,34.46308530288468,34.46100620201079,34.46002679780228,34.45924710335544,34.4575545993213,34.45676840340386,34.45520899812012,34.45508230197013,34.45118399665709,34.45060410251845,34.44943779575708,34.44709869829975,34.44612579806175,34.44573269726995,34.44027479595007,34.43864879979049,34.43826219610871,34.43690260137969,34.43658250216981,34.43671560310509,34.43795499982529,34.43932739975563,34.43966030217926,34.44070629912492,34.44097250274743,34.44181880236481,34.44671570274234,34.4468487958576,34.44808810249901,34.4489405979965,34.44686130048253,34.44646829657989,34.44484230176831,34.44321010060497,34.44243029871197,34.44014519754814,34.43839230288852,34.43767289855622,34.43656670183903,34.43617370453528,34.4351339983692,34.43278229860869,34.43219590247939,34.43212299842864,34.42879169869808,34.42696599755936,34.42644620253393,34.4251402988716,34.42462040229069,34.42272810113772,34.42142859748505,34.42162829796185,34.42489309748074,34.42528610012504]}]],[[{"lng":[-119.8022752035251,-119.8029054022063,-119.8044180945006,-119.8050483022932,-119.8062420043745,-119.8092082095316,-119.8109656125502,-119.811455231263,-119.8105802918393,-119.8101949510435,-119.8102327275292,-119.8089647466263,-119.8092911777933,-119.8087349978136,-119.8091505989295,-119.8097143051097,-119.811635303749,-119.8146023028871,-119.8161228982325,-119.8169239957073,-119.8175694998357,-119.8182889049689,-119.818778800493,-119.8196616024417,-119.820723196841,-119.8210421046698,-119.8225938001958,-119.822994401367,-119.8237295033682,-119.8236634008122,-119.824561897044,-119.8255266032083,-119.8266470031082,-119.8278489963119,-119.8292883997755,-119.8304904953801,-119.8310546016911,-119.8321750051178,-119.8336144027161,-119.8344896998816,-119.8373604953698,-119.8386444028323,-119.8424722952284,-119.8443043958364,-119.8456701006773,-119.846324203236,-119.8474447042191,-119.8497594011504,-119.8522294980916,-119.8551002967158,-119.8574148994041,-119.8578974991325,-119.8590915038265,-119.8610053987956,-119.8615615021229,-119.8623630021659,-119.8636389023115,-119.863884405536,-119.8648496001516,-119.8666081049862,-119.8668536050159,-119.8686940011192,-119.8691032011303,-119.8683917988238,-119.8667884994172,-119.8655125987728,-119.8647192974915,-119.8628872009394,-119.859059299434,-119.8580286992086,-119.8571452965717,-119.855476704869,-119.8544379002748,-119.8531537023826,-119.8508306984243,-119.8491539010655,-119.8469207996205,-119.8462010003293,-119.844287000644,-119.842929198644,-119.8413181017847,-119.8374899948989,-119.8344632995475,-119.8325649030464,-119.8325727970414,-119.8305768019719,-119.8271334019638,-119.825538196715,-119.8227408034063,-119.8225034983885,-119.8196243970713,-119.8160995024941,-119.8138661974445,-119.8127457979883,-119.8101192991794,-119.8086056980964,-119.8050959994792,-119.8042279978977,-119.8036715026525,-119.8030332977626,-119.8016680023603,-119.7998352015906,-119.7992711979441,-119.7982324029409,-119.7950416010972,-119.794077099134,-119.7935874959241,-119.7928604022892,-119.7935728007615,-119.7930906036245,-119.792356298249,-119.7916365942256,-119.7912213979179,-119.7939221954936,-119.7937590043747,-119.7952725981922,-119.7957473968035,-119.7957400973624,-119.7955695001926,-119.796519196233,-119.7965859991724,-119.7960148997789,-119.7965639977986,-119.7956739032853,-119.7959038976352,-119.7973355969026,-119.7980402966952,-119.7979514008691,-119.7981887005659,-119.7976177008063,-119.7980923955591,-119.7979217988588,-119.7982334040896,-119.7992569022321,-119.8000505003207,-119.799805804169,-119.8005177948409,-119.7997909983753,-119.8003471971818,-119.7998577048559,-119.8007254048321,-119.8015188985332,-119.8016746027025,-119.8034987949545,-119.802690499826,-119.8031649976208,-119.8022752035251],"lat":[34.46124890217073,34.46000969808689,34.45941729719403,34.45817819968623,34.45765219855518,34.45952585705939,34.45971309552975,34.46127255405375,34.46173201928721,34.46375093708693,34.46928169758316,34.47065390030957,34.47169353760528,34.47208646984132,34.47449219651271,34.47520540145548,34.47591240052736,34.47778589831236,34.47829939953459,34.47868619701945,34.47965919725785,34.47978610179461,34.48134550145507,34.48199209808317,34.48537069975639,34.4853042028148,34.49024220366869,34.49043550028489,34.49277450076274,34.49472689808398,34.49758569787834,34.49849209544253,34.49881219843714,34.49939219851823,34.4996456979108,34.50022569722204,34.50093869986296,34.50125880182978,34.50151230026382,34.50105259894195,34.50045339901256,34.50129309872489,34.50049399827418,34.49983439992302,34.50093400039938,34.50301299722817,34.50333290099673,34.50312639959369,34.50233350000507,34.50173380339986,34.50152719669038,34.50198029754779,34.50145390087648,34.50105399764658,34.50066079997195,34.50104719563274,34.50078060279437,34.50156020268972,34.50246630023942,34.50265270053433,34.50343220096966,34.50387840330023,34.50517769888947,34.50615730427347,34.50538459923223,34.5056512033279,34.50637100069209,34.50703080162306,34.50783060261216,34.50887679792317,34.50823049781084,34.50940989988716,34.50934990072552,34.50851039614646,34.50761079865276,34.50768410235178,34.50815040034484,34.50802370232936,34.50842339587417,34.50842990189292,34.50655069554372,34.50734989854389,34.50853549848959,34.51114710107751,34.51225319650537,34.51239279859097,34.51117269578479,34.51150550162883,34.51125819884,34.511584596198,34.51107739904997,34.50959710186359,34.51006279708466,34.50974260225358,34.51112090302428,34.5117133972709,34.51244490307152,34.5140104002287,34.5144033029422,34.51453630443109,34.51343629587188,34.51409510114571,34.51338190202399,34.51332139867952,34.5139861966006,34.51307949638997,34.51152010020034,34.51028699609807,34.50930789721267,34.50885450256909,34.50651529719586,34.50638829747476,34.50398269740974,34.50175860027378,34.50123879782925,34.50064649659144,34.49999369842349,34.49888760438421,34.49726170323454,34.49595609830238,34.49400379914896,34.49218440098429,34.49068549650303,34.48893260183264,34.48750000388495,34.48664780349345,34.48456250030291,34.48319649872503,34.48287010376652,34.48105070372917,34.48039789882132,34.47877189841739,34.47759930139097,34.47544749589819,34.47472820043902,34.4739485006818,34.47296929919547,34.47173619945031,34.47134329811524,34.46978380137224,34.46821830213123,34.46749900250276,34.46691259843048,34.46514759871423,34.46365459999897,34.46300180458217,34.46124890217073]}]],[[{"lng":[-119.8240731948911,-119.8259698018833,-119.8265255995537,-119.8288961019337,-119.8298520988114,-119.8302602981149,-119.8291567008964,-119.8293198969771,-119.8283716998111,-119.8285349033279,-119.8277498967146,-119.8250603009815,-119.8233852033907,-119.8232297041127,-119.8212512037261,-119.8215775978596,-119.8210217015363,-119.8210293944704,-119.8202364013058,-119.8211264978285,-119.8194665043493,-119.8197113043916,-119.8185255013865,-119.818696402824,-119.8181404972157,-119.8187933998417,-119.8183189979637,-119.8192831053539,-119.8192908013226,-119.8198620950212,-119.8209817984248,-119.8212267039466,-119.8201963042245,-119.8206861046088,-119.8199745021984,-119.8209464029125,-119.8201531960846,-119.8205613956902,-119.8213777987895,-119.8216966012984,-119.8229213035378,-119.8228473975655,-119.8244495024143,-119.8246944990448,-119.8257327972145,-119.8267049952378,-119.8282255014336,-119.827914402597,-119.8281594972311,-119.8272845009717,-119.8269733997827,-119.8260982990574,-119.8268411983974,-119.8275606983558,-119.8278136014778,-119.8285487000342,-119.8273624953874,-119.8264057040583,-119.8254565993583,-119.8244997982833,-119.822994401367,-119.8225938001958,-119.8210421046698,-119.820723196841,-119.8196616024417,-119.818778800493,-119.8182889049689,-119.8175694998357,-119.8169239957073,-119.8161228982325,-119.8146023028871,-119.811635303749,-119.8097143051097,-119.8091505989295,-119.8087349978136,-119.8092911777933,-119.8089647466263,-119.8102327275292,-119.8101949510435,-119.8105802918393,-119.811455231263,-119.8109656125502,-119.8092082095316,-119.8062420043745,-119.8050483022932,-119.8044180945006,-119.8029054022063,-119.8022752035251,-119.8031649976208,-119.802690499826,-119.8034987949545,-119.8016746027025,-119.8009478980433,-119.8002137046019,-119.7986194026031,-119.7973291975575,-119.79788530339,-119.7978780006471,-119.7983525010962,-119.7996278999215,-119.7993831986698,-119.7996946981326,-119.8002507966338,-119.8028015023114,-119.8034316996578,-119.8031053972961,-119.805077502757,-119.8058708001599,-119.8053812958418,-119.805774198177,-119.8053663050419,-119.8059223954959,-119.806233603189,-119.805988903362,-119.8071749982926,-119.8078125001873,-119.8080497014035,-119.8125124039352,-119.8144989976902,-119.815847904418,-119.8167149018791,-119.8173524008228,-119.8194865984885,-119.8193234022452,-119.8209092983338,-119.8223319024754,-119.8234358018784,-119.8240731948911],"lat":[34.42789789775298,34.42528610012504,34.42489309748074,34.42162829796185,34.42142859748505,34.42272810113772,34.42462040229069,34.4251402988716,34.42644620253393,34.42696599755936,34.42879169869808,34.43212299842864,34.43219590247939,34.43278229860869,34.4351339983692,34.43617370453528,34.43656670183903,34.43767289855622,34.43839230288852,34.44014519754814,34.44243029871197,34.44321010060497,34.44484230176831,34.44646829657989,34.44686130048253,34.4489405979965,34.44959350132201,34.45050000199185,34.4516062004389,34.45342549721812,34.45374570053178,34.45452540292552,34.45557130231993,34.45713079967118,34.45811010311055,34.46012279626798,34.46084220281713,34.46214179864607,34.46474079686971,34.46467420100562,34.46857270330636,34.46941899984394,34.47019240106985,34.4709719974844,34.4710322991247,34.47304490081351,34.47355829616077,34.47473099610114,34.47551070393086,34.47597030260573,34.47714300059824,34.47760259769093,34.48104770310494,34.48117450307861,34.48306030346517,34.48539930144933,34.48703160100865,34.48723130296369,34.48853710179861,34.48873670182007,34.49043550028489,34.49024220366869,34.4853042028148,34.48537069975639,34.48199209808317,34.48134550145507,34.47978610179461,34.47965919725785,34.47868619701945,34.47829939953459,34.47778589831236,34.47591240052736,34.47520540145548,34.47449219651271,34.47208646984132,34.47169353760528,34.47065390030957,34.46928169758316,34.46375093708693,34.46173201928721,34.46127255405375,34.45971309552975,34.45952585705939,34.45765219855518,34.45817819968623,34.45941729719403,34.46000969808689,34.46124890217073,34.46300180458217,34.46365459999897,34.46514759871423,34.46691259843048,34.46567960250342,34.46334030216998,34.46367280088511,34.46172639980947,34.46133349609183,34.46022729848855,34.45957449868989,34.45930860142475,34.45852879939319,34.45735619661053,34.45696329704372,34.45643130082092,34.45519220199368,34.4541524993911,34.45069489746736,34.44997549896147,34.44841600287783,34.44750330110731,34.44620370197922,34.44581079913917,34.44463809987814,34.44385830234387,34.44222620131364,34.44209320370257,34.44176670072316,34.44083550315078,34.43959000344571,34.43847759842219,34.4369118965753,34.43677880080526,34.43384079749269,34.43332090236119,34.43188199793501,34.42992319815421,34.42803100227203,34.42789789775298]}]],[[{"lng":[-119.7890096037196,-119.7855022006679,-119.7847085992559,-119.7833660026206,-119.7825723968855,-119.7794650036748,-119.7784268991445,-119.779213403654,-119.7804073999649,-119.7808006962046,-119.7823135000053,-119.7832629011204,-119.7846941986903,-119.7872450992865,-119.7875567000946,-119.7910639992777,-119.7924878023628,-119.7927993011707,-119.7942304010997,-119.7941414947683,-119.7949348988793,-119.7974038000885,-119.7979525002712,-119.7987457952528,-119.8003398012924,-119.8004954991638,-119.8016891022698,-119.8024007984147,-119.8035127996031,-119.8036684981499,-119.8050991982696,-119.8070117982794,-119.8071749982926,-119.805988903362,-119.806233603189,-119.8059223954959,-119.8053663050419,-119.805774198177,-119.8053812958418,-119.8058708001599,-119.805077502757,-119.8031053972961,-119.8034316996578,-119.8028015023114,-119.8002507966338,-119.7996946981326,-119.7993831986698,-119.7996278999215,-119.7983525010962,-119.7978780006471,-119.79788530339,-119.7973291975575,-119.7986194026031,-119.8002137046019,-119.8009478980433,-119.8016746027025,-119.8015188985332,-119.8007254048321,-119.7998577048559,-119.8003471971818,-119.7997909983753,-119.8005177948409,-119.799805804169,-119.8000505003207,-119.7992569022321,-119.7982334040896,-119.7979217988588,-119.7980923955591,-119.7976177008063,-119.7981887005659,-119.7979514008691,-119.7980402966952,-119.7973355969026,-119.7959038976352,-119.7956739032853,-119.7965639977986,-119.7960148997789,-119.7965859991724,-119.796519196233,-119.7955695001926,-119.7957400973624,-119.7957473968035,-119.7952725981922,-119.7937590043747,-119.7927946014562,-119.7930321029338,-119.7924610020518,-119.7904580968171,-119.7898127967993,-119.7866898036361,-119.7861189036881,-119.7845166999301,-119.7819647012897,-119.7815712977921,-119.7823052046825,-119.7820748943275,-119.7827272004658,-119.7820148019019,-119.7822594014407,-119.7809089034298,-119.7794838979972,-119.7791718981243,-119.7779772000571,-119.7774276970069,-119.7765520983737,-119.7768781949074,-119.7760840977778,-119.775126795904,-119.7748148057936,-119.7728116960673,-119.7717729968515,-119.7700890983566,-119.768330600816,-119.7676040052483,-119.7673526028305,-119.7691785008421,-119.7687708969153,-119.7692460000559,-119.7688384963066,-119.7693880980429,-119.7689806001384,-119.7696117031646,-119.7694346978519,-119.7703918021077,-119.7726107981988,-119.773723796688,-119.7746808047633,-119.7750742976987,-119.7763502040343,-119.7795259037615,-119.7803940999349,-119.7813511001636,-119.7821449037495,-119.7834206984513,-119.7834136024583,-119.7839699031517,-119.7835622952441,-119.7841185950412,-119.7844304030291,-119.7853871999255,-119.7860993991948,-119.786173796679,-119.786559800502,-119.7875908996611,-119.7879841024902,-119.7890150982992,-119.7895640973479,-119.790201903255,-119.7908324991132,-119.7905063022968,-119.7908105979853,-119.7918414971742,-119.7924719973867,-119.7927019981038,-119.7938885996504,-119.7931546975498,-119.79307319703,-119.7889281059785,-119.7890096037196],"lat":[34.45902999841933,34.45976099736876,34.46048020234878,34.46269829815496,34.46341750158579,34.46434179838932,34.46428120306976,34.46245589755173,34.46193020237799,34.46101760083453,34.46042540385459,34.4591198989495,34.45826790418672,34.4577361981998,34.45656360175752,34.45583260051462,34.45387420171263,34.45270159583868,34.45184939755335,34.45048329934767,34.44976399849039,34.44897219814901,34.44747320140695,34.44675389768332,34.44642139638902,34.44583509863051,34.4453091988414,34.44432989703107,34.44354410224759,34.44295770056093,34.4421053968087,34.44170639970924,34.44222620131364,34.44385830234387,34.44463809987814,34.44581079913917,34.44620370197922,34.44750330110731,34.44841600287783,34.44997549896147,34.45069489746736,34.4541524993911,34.45519220199368,34.45643130082092,34.45696329704372,34.45735619661053,34.45852879939319,34.45930860142475,34.45957449868989,34.46022729848855,34.46133349609183,34.46172639980947,34.46367280088511,34.46334030216998,34.46567960250342,34.46691259843048,34.46749900250276,34.46821830213123,34.46978380137224,34.47134329811524,34.47173619945031,34.47296929919547,34.4739485006818,34.47472820043902,34.47544749589819,34.47759930139097,34.47877189841739,34.48039789882132,34.48105070372917,34.48287010376652,34.48319649872503,34.48456250030291,34.48664780349345,34.48750000388495,34.48893260183264,34.49068549650303,34.49218440098429,34.49400379914896,34.49595609830238,34.49726170323454,34.49888760438421,34.49999369842349,34.50064649659144,34.50123879782925,34.50033199807167,34.50000570141471,34.49818629847837,34.49721899892501,34.49624589936079,34.49495809629598,34.4931386986275,34.49236480088693,34.49289629697117,34.4938089021383,34.49614819926524,34.49758069784983,34.49965999655913,34.50063909635736,34.50141890141472,34.50253079835124,34.50448889986841,34.50566140298836,34.50618709639176,34.50768589830397,34.50814510300525,34.5091847984347,34.50990390173796,34.51010319770673,34.51127570274303,34.51030809935738,34.51024740301373,34.50921350329125,34.50902559904189,34.50779240209614,34.50590650080957,34.50414209924809,34.50284240389218,34.50218980085896,34.50089010051767,34.4993912982782,34.49809170363054,34.4968527003159,34.49412069674123,34.49392139706853,34.4912443018986,34.49045880428647,34.49025960149258,34.48934700209669,34.48908129855841,34.48620480205064,34.48463939616665,34.48444010378272,34.48372089878751,34.48345519815341,34.48234900232649,34.48195619585378,34.48065660073226,34.48026379859417,34.47909120147845,34.47889190062253,34.4779127967196,34.47706659779267,34.47504769671732,34.4740022040397,34.47308949751402,34.47204390230506,34.47054489904281,34.47041200191219,34.4691728989982,34.46813319543193,34.46585449969711,34.46480879647267,34.46356969829986,34.46213720159257,34.46050519815032,34.45816589984693,34.4579060045041,34.45877000287626,34.45902999841933]}]],[[{"lng":[-119.7641785992493,-119.7652912987563,-119.7658408027038,-119.7654335022658,-119.7668582020804,-119.7670887052093,-119.7678825000712,-119.7713902018265,-119.7724212985726,-119.7740156995416,-119.7746464039695,-119.7763896002124,-119.7776651020743,-119.779719805384,-119.7815442969054,-119.781218299804,-119.7844065975656,-119.7852742989618,-119.7862308016972,-119.7871129957463,-119.7891889024358,-119.7898192946825,-119.7922736042681,-119.7927482012116,-119.7943421010687,-119.7956914971277,-119.797922997917,-119.798634695093,-119.7987089016976,-119.8003842945401,-119.8018966019179,-119.8032531965666,-119.8040538986955,-119.8050991982696,-119.8036684981499,-119.8035127996031,-119.8024007984147,-119.8016891022698,-119.8004954991638,-119.8003398012924,-119.7987457952528,-119.7979525002712,-119.7974038000885,-119.7949348988793,-119.7941414947683,-119.7942304010997,-119.7927993011707,-119.7924878023628,-119.7910639992777,-119.7875567000946,-119.7872450992865,-119.7846941986903,-119.7832629011204,-119.7823135000053,-119.7808006962046,-119.7804073999649,-119.779213403654,-119.7784268991445,-119.7773213958831,-119.7757269015466,-119.7749401990376,-119.7741464960616,-119.7747983969101,-119.7759996993138,-119.7762441029215,-119.7746494979614,-119.7723425990085,-119.7716302029828,-119.7697165965808,-119.7693161976801,-119.7683593008071,-119.7682847965024,-119.7672535016488,-119.7671789026297,-119.7659099952538,-119.7659170032404,-119.7671182988155,-119.7677631998235,-119.7680960007871,-119.7693998992188,-119.769495298371,-119.7700657972927,-119.7694346978519,-119.7696117031646,-119.7689806001384,-119.7693880980429,-119.7688384963066,-119.7692460000559,-119.7687708969153,-119.7691785008421,-119.7673526028305,-119.7676040052483,-119.7659271011485,-119.7646439025232,-119.7633675975761,-119.7612087003402,-119.7607265959139,-119.7593689032189,-119.7580042991164,-119.7566465009927,-119.7564836008249,-119.7552005038564,-119.7542432953276,-119.7528788012102,-119.7527906012668,-119.7517318042471,-119.7512499040706,-119.7523632005111,-119.7529877972206,-119.7534628948858,-119.7532119002113,-119.7537685045225,-119.7534427025441,-119.754230101136,-119.7547866978452,-119.755017496209,-119.7562798966096,-119.7554790044086,-119.7546645973582,-119.7544135994607,-119.75600159564,-119.7588723018154,-119.7606976986793,-119.7618852016006,-119.764117797056,-119.765312103683,-119.7657055947878,-119.7649048034761,-119.7641785992493],"lat":[34.47084809747166,34.47006259796252,34.46856369888877,34.46726400123964,34.46530599968358,34.4638735016588,34.4631544038421,34.46242400040978,34.46137850197366,34.46104640345358,34.45980739851167,34.45778290030567,34.45751719763515,34.45431990287131,34.45255520122814,34.45151550060086,34.45085110184343,34.44928559611522,34.44908619919436,34.44973310114116,34.44985419788742,34.44861509872315,34.44561109961966,34.44495829932341,34.44462599886063,34.44351380189188,34.44304840156236,34.44206920034658,34.44122289617383,34.44115039799576,34.44055799953775,34.4405520000122,34.44093879896927,34.4421053968087,34.44295770056093,34.44354410224759,34.44432989703107,34.4453091988414,34.44583509863051,34.44642139638902,34.44675389768332,34.44747320140695,34.44897219814901,34.44976399849039,34.45048329934767,34.45184939755335,34.45270159583868,34.45387420171263,34.45583260051462,34.45656360175752,34.4577361981998,34.45826790418672,34.4591198989495,34.46042540385459,34.46101760083453,34.46193020237799,34.46245589755173,34.46428120306976,34.46617289909413,34.46650509943792,34.46833029713293,34.46904949695445,34.47112889785573,34.47170949877122,34.47248920185551,34.47282139666929,34.47413249938568,34.47511150226676,34.4755100029671,34.47531639713399,34.47551559665112,34.47636180095628,34.47740719970073,34.47825350135825,34.47962520022955,34.48073130032017,34.48131189692673,34.48228530254342,34.48443109621768,34.48858999847908,34.49106220386144,34.49288170277669,34.49412069674123,34.4968527003159,34.49809170363054,34.4993912982782,34.50089010051767,34.50218980085896,34.50284240389218,34.50414209924809,34.50590650080957,34.50779240209614,34.50786439833039,34.5070238987994,34.50728939882539,34.50690789855623,34.50645450017434,34.5064600001301,34.5053595021425,34.50536499630547,34.50484520029773,34.50400449661662,34.50420359882687,34.50310299707684,34.50173689870075,34.49835769749543,34.4979042024481,34.49711890105844,34.49477399998614,34.49412139899677,34.49223540072293,34.49184280101558,34.49080299741539,34.48897790017823,34.48858519841681,34.48715280344504,34.48467509750052,34.4842879018958,34.48168850307127,34.47980250017157,34.47836460144692,34.47776719628782,34.47600290216337,34.47437129730439,34.47390660171501,34.47338110306073,34.47246849824636,34.47208139896395,34.47084809747166]}]],[[{"lng":[-119.8257327972145,-119.8246944990448,-119.8244495024143,-119.8228473975655,-119.8229213035378,-119.8216966012984,-119.8213777987895,-119.8205613956902,-119.8201531960846,-119.8209464029125,-119.8199745021984,-119.8206861046088,-119.8201963042245,-119.8212267039466,-119.8209817984248,-119.8198620950212,-119.8192908013226,-119.8192831053539,-119.8183189979637,-119.8187933998417,-119.8202241014225,-119.8208540018466,-119.8214915013784,-119.8250486052253,-119.825122499315,-119.8263974976034,-119.8274274960797,-119.8290213024398,-119.8302883968972,-119.8309179963904,-119.8315554004074,-119.8326748991908,-119.8341209988313,-119.8349217955357,-119.8350930011255,-119.8368080994613,-119.8362522024888,-119.8368976994035,-119.8376328008763,-119.8386786968511,-119.8398800991411,-119.8411055026356,-119.8418247990127,-119.8423150013288,-119.8412031971081,-119.8410558030532,-119.8413008995474,-119.8405895956536,-119.8412431982206,-119.842608298022,-119.8431802970943,-119.8427059987281,-119.8427139967158,-119.8417734960145,-119.8411357975525,-119.8407431969547,-119.8394678011033,-119.8389934972287,-119.8373174036044,-119.8368430994549,-119.835011498186,-119.8336701046247,-119.8320756954314,-119.8295324025166,-119.8288207017067,-119.8285096032625,-119.8275606983558,-119.8268411983974,-119.8260982990574,-119.8269733997827,-119.8272845009717,-119.8281594972311,-119.827914402597,-119.8282255014336,-119.8267049952378,-119.8257327972145],"lat":[34.4710322991247,34.4709719974844,34.47019240106985,34.46941899984394,34.46857270330636,34.46467420100562,34.46474079686971,34.46214179864607,34.46084220281713,34.46012279626798,34.45811010311055,34.45713079967118,34.45557130231993,34.45452540292552,34.45374570053178,34.45342549721812,34.4516062004389,34.45050000199185,34.44959350132201,34.4489405979965,34.44808810249901,34.4468487958576,34.44671570274234,34.44181880236481,34.44097250274743,34.44070629912492,34.43966030217926,34.43932739975563,34.43795499982529,34.43671560310509,34.43658250216981,34.43690260137969,34.43826219610871,34.43864879979049,34.44027479595007,34.44573269726995,34.44612579806175,34.44709869829975,34.44943779575708,34.45060410251845,34.45118399665709,34.45508230197013,34.45520899812012,34.45676840340386,34.4575545993213,34.45924710335544,34.46002679780228,34.46100620201079,34.46308530288468,34.46418500062983,34.46600420134623,34.4666571988834,34.46776329923158,34.47017540161387,34.47030860225635,34.47122149877828,34.47148789656303,34.47214080432988,34.4722139020644,34.47286690389432,34.47352629641845,34.47574499857343,34.47607789926575,34.47771660261012,34.47869599947423,34.47986869990243,34.48117450307861,34.48104770310494,34.47760259769093,34.47714300059824,34.47597030260573,34.47551070393086,34.47473099610114,34.47355829616077,34.47304490081351,34.4710322991247]}]],[[{"lng":[-119.7469987979625,-119.7458727991724,-119.7450656991838,-119.7454592990159,-119.7455274025213,-119.7447950960759,-119.7464573964336,-119.7473258045962,-119.7491574022087,-119.7499511010351,-119.7512264017448,-119.7526577002087,-119.7533699036194,-119.7524000996553,-119.7530309037459,-119.7547809001311,-119.7557372961385,-119.7566190033074,-119.758775903545,-119.7610073952227,-119.7614007966014,-119.7640324009265,-119.7647445014356,-119.7660196000279,-119.766012704731,-119.7679251977719,-119.7694306038873,-119.7711057990592,-119.7722249996646,-119.7729579950605,-119.7747146959393,-119.7752033988104,-119.7750474990167,-119.7731348965198,-119.773060499332,-119.7719483007728,-119.7708429983121,-119.7702053986306,-119.7692560030714,-119.7668685024121,-119.7664751994198,-119.7655187999973,-119.7644063963984,-119.7635383007824,-119.7627446970428,-119.7614693968282,-119.7615575995762,-119.7607640020267,-119.7612524974804,-119.7601467944081,-119.7590343003533,-119.7592038973113,-119.7584915983789,-119.7592175960305,-119.7584237999674,-119.7585935001374,-119.7591634954424,-119.7586884950981,-119.7591770978522,-119.7586275969097,-119.7574333969021,-119.757921896432,-119.7590414968577,-119.7599304964223,-119.7588991981798,-119.7590689014126,-119.7583563997901,-119.7567684987991,-119.7552552015781,-119.7550108969875,-119.7538097985998,-119.7531584016407,-119.753470597978,-119.7519507042336,-119.7516250051257,-119.750905798927,-119.7503358982045,-119.7495352968465,-119.7492029987468,-119.7479006984663,-119.7476498984174,-119.7469987979625],"lat":[34.45504089960585,34.45361389824575,34.45212049624377,34.45120790047842,34.44925550316668,34.44691589763604,34.44463180415028,34.44306660100744,34.44240850268697,34.44168960112122,34.44142409702516,34.44057240028786,34.43959349833656,34.43758020215487,34.43634130041973,34.4354231962576,34.4352240991516,34.43587119956329,34.43625279828089,34.43578809705066,34.43487549829653,34.43460429856462,34.4336253004416,34.43335970235973,34.43225350248663,34.43185509766539,34.43015690009398,34.4300848022898,34.43040549994564,34.43274499905873,34.43293279957044,34.43449240380031,34.43507869899931,34.43547729953902,34.43632350091293,34.43710910143781,34.43900080121044,34.4391336012288,34.44043900064815,34.44149010188423,34.442402797733,34.44260200254126,34.44338750017594,34.44495280276674,34.44567180194353,34.44593739940754,34.4473034969277,34.44802260345305,34.44958220199573,34.45147379831367,34.45225930068595,34.45388530048166,34.45486429628547,34.45609769864913,34.45681670032525,34.45844280331656,34.46026240014065,34.4609149995458,34.46247470244526,34.46397360364868,34.46449899653292,34.46605870258657,34.46637940255354,34.46813269809125,34.46917799962127,34.47080400284082,34.47178299654463,34.47322099708041,34.47381279745015,34.47303299930715,34.47245220229239,34.47037259765133,34.4692001034425,34.46868569951891,34.46764590045027,34.4675187040362,34.46569900021132,34.46531180000615,34.4631659009076,34.45900660065942,34.4571206006652,34.45504089960585]}]],[[{"lng":[-119.7847733034422,-119.7838242957173,-119.7793614964649,-119.7792056978868,-119.7768928004004,-119.7764996997406,-119.7754689028925,-119.7754759984558,-119.7747640019613,-119.7738076022302,-119.7741334956207,-119.7728582985121,-119.7714270994153,-119.7709594020164,-119.769847100887,-119.7704101963997,-119.770899000487,-119.7720998040335,-119.7725070957196,-119.772195304402,-119.7726026035655,-119.7720463968132,-119.7720533994095,-119.7710223967943,-119.7699168970295,-119.770005299394,-119.7673121999239,-119.767719500708,-119.7670887052093,-119.7668582020804,-119.7654335022658,-119.7658408027038,-119.7652912987563,-119.7641785992493,-119.7597135007802,-119.7583563997901,-119.7590689014126,-119.7588991981798,-119.7599304964223,-119.7590414968577,-119.757921896432,-119.7574333969021,-119.7586275969097,-119.7591770978522,-119.7586884950981,-119.7591634954424,-119.7585935001374,-119.7584237999674,-119.7592175960305,-119.7584915983789,-119.7592038973113,-119.7590343003533,-119.7601467944081,-119.7612524974804,-119.7607640020267,-119.7615575995762,-119.7614693968282,-119.7627446970428,-119.7635383007824,-119.7644063963984,-119.7655187999973,-119.7664751994198,-119.7668685024121,-119.7692560030714,-119.7702053986306,-119.7708429983121,-119.7719483007728,-119.773060499332,-119.7731348965198,-119.7750474990167,-119.7752033988104,-119.7747146959393,-119.7729579950605,-119.7722249996646,-119.7731811999929,-119.7738932016835,-119.7736487998527,-119.7741977992899,-119.7760287975112,-119.7782528034981,-119.7779270007798,-119.7795206008229,-119.780313798346,-119.7818259021435,-119.7826933955483,-119.7852430018642,-119.786843699248,-119.7919428983843,-119.7942551983398,-119.7953742950184,-119.7972863982495,-119.7987241963833,-119.8003175973523,-119.801117996231,-119.8031115991939,-119.8039121001738,-119.8057426013839,-119.8114786954565,-119.8125978031723,-119.8181043999687,-119.8196976970333,-119.8204982009711,-119.8209061982805,-119.8217066994303,-119.8231367980661,-119.8259232014835,-119.8279167001703,-119.8283986005026,-119.8292808010977,-119.8295255966739,-119.8283325973729,-119.8282588003588,-119.8265099975326,-119.8257988019095,-119.8248427984281,-119.824768900694,-119.8235835017674,-119.8213526985205,-119.8208707972831,-119.8189585977797,-119.817609901795,-119.818344197495,-119.8184335022975,-119.8178775992777,-119.8147948999693,-119.8132902990473,-119.812015302085,-119.811214705801,-119.8099397014771,-119.8104065043007,-119.809345996023,-119.809894396178,-119.8094050024173,-119.8111466023479,-119.8115392961617,-119.8111313955902,-119.8103308951598,-119.806825200953,-119.8058766009858,-119.8054913036841,-119.8044609985238,-119.8025636053073,-119.8029713000224,-119.8023412997183,-119.8028304988055,-119.7999839996923,-119.7987089016976,-119.798634695093,-119.797922997917,-119.7956914971277,-119.7943421010687,-119.7927482012116,-119.7922736042681,-119.7916287037003,-119.7913768974188,-119.7907248046561,-119.79168109875,-119.7905398987668,-119.7893391003434,-119.7883012967766,-119.787812302476,-119.7881239025413,-119.7876348997121,-119.7861154035976,-119.7846103965897,-119.7847733034422],"lat":[34.43360549790759,34.43491110013539,34.4358412001074,34.43642760115647,34.43663260307424,34.43754530052187,34.43859079572344,34.43969699836633,34.44067609998439,34.44087539876468,34.44191509951322,34.44218079734965,34.44303280146984,34.44479169702657,34.44557720327646,34.44629059666165,34.4478502979106,34.4484308027342,34.44973050142873,34.45090309804655,34.45220280249578,34.45259559769563,34.4537018004397,34.45474719750008,34.45663890044901,34.45800499994978,34.46133489702621,34.46263459696119,34.4638735016588,34.46530599968358,34.46726400123964,34.46856369888877,34.47006259796252,34.47084809747166,34.47177739682461,34.47178299654463,34.47080400284082,34.46917799962127,34.46813269809125,34.46637940255354,34.46605870258657,34.46449899653292,34.46397360364868,34.46247470244526,34.4609149995458,34.46026240014065,34.45844280331656,34.45681670032525,34.45609769864913,34.45486429628547,34.45388530048166,34.45225930068595,34.45147379831367,34.44958220199573,34.44802260345305,34.4473034969277,34.44593739940754,34.44567180194353,34.44495280276674,34.44338750017594,34.44260200254126,34.442402797733,34.44149010188423,34.44043900064815,34.4391336012288,34.43900080121044,34.43710910143781,34.43632350091293,34.43547729953902,34.43507869899931,34.43449240380031,34.43293279957044,34.43274499905873,34.43040549994564,34.43020620229328,34.42922709814817,34.42844730118436,34.42694830078933,34.42628979913185,34.42471860037251,34.42367880034616,34.42334670384062,34.42262750170289,34.42203530022027,34.42046979837602,34.41993820109543,34.42071219833159,34.41964880313655,34.41944340111901,34.41976379859639,34.41936489999886,34.41961880388009,34.41928640198134,34.41967330316741,34.41953420226897,34.4199209998216,34.41926210046046,34.41806479865032,34.41838509776492,34.41862009804929,34.41828739755051,34.41867409567885,34.41997370081187,34.42036040366749,34.41950780344367,34.41864890310408,34.41850940120252,34.41896260295863,34.41960920042711,34.42038900048951,34.42091520229241,34.42176149800731,34.42268070020698,34.42366009955231,34.42385980124907,34.42470609604721,34.42633839718682,34.4268043014121,34.42635099847006,34.42675029864022,34.42786279592889,34.43020200077927,34.4315680968765,34.43196110285961,34.43620490031654,34.43790370340687,34.43816979768673,34.43778300285349,34.4380490998516,34.43629000295722,34.43291109930409,34.43141190121998,34.42985239802411,34.42782729662567,34.42691450311727,34.42561489723156,34.42522809869018,34.42595969748341,34.42726550277989,34.429284403327,34.43033020007422,34.43294160273533,34.43424119875414,34.43548040102043,34.43704000025381,34.44095699718662,34.44122289617383,34.44206920034658,34.44304840156236,34.44351380189188,34.44462599886063,34.44495829932341,34.44561109961966,34.44463789593141,34.44275189842513,34.44067250276406,34.44047310247022,34.43683410421953,34.43625369782333,34.43619310286626,34.43463350205785,34.43346090169681,34.43190120163965,34.43138730152123,34.43308570022808,34.43360549790759]}]],[[{"lng":[-119.7931546975498,-119.79307319703,-119.7889281059785,-119.7890096037196,-119.7855022006679,-119.7847085992559,-119.7833660026206,-119.7825723968855,-119.7794650036748,-119.7784268991445,-119.7773213958831,-119.7757269015466,-119.7749401990376,-119.7741464960616,-119.7747983969101,-119.7759996993138,-119.7762441029215,-119.7746494979614,-119.7723425990085,-119.7716302029828,-119.7697165965808,-119.7693161976801,-119.7683593008071,-119.7682847965024,-119.7672535016488,-119.7671789026297,-119.7659099952538,-119.7659170032404,-119.7671182988155,-119.7677631998235,-119.7680960007871,-119.7693998992188,-119.769495298371,-119.7700657972927,-119.7694346978519,-119.7703918021077,-119.7726107981988,-119.773723796688,-119.7746808047633,-119.7750742976987,-119.7763502040343,-119.7795259037615,-119.7803940999349,-119.7813511001636,-119.7821449037495,-119.7834206984513,-119.7834136024583,-119.7839699031517,-119.7835622952441,-119.7841185950412,-119.7844304030291,-119.7853871999255,-119.7860993991948,-119.786173796679,-119.786559800502,-119.7875908996611,-119.7879841024902,-119.7890150982992,-119.7895640973479,-119.790201903255,-119.7908324991132,-119.7905063022968,-119.7908105979853,-119.7918414971742,-119.7924719973867,-119.7927019981038,-119.7938885996504,-119.7931546975498],"lat":[34.45816589984693,34.4579060045041,34.45877000287626,34.45902999841933,34.45976099736876,34.46048020234878,34.46269829815496,34.46341750158579,34.46434179838932,34.46428120306976,34.46617289909413,34.46650509943792,34.46833029713293,34.46904949695445,34.47112889785573,34.47170949877122,34.47248920185551,34.47282139666929,34.47413249938568,34.47511150226676,34.4755100029671,34.47531639713399,34.47551559665112,34.47636180095628,34.47740719970073,34.47825350135825,34.47962520022955,34.48073130032017,34.48131189692673,34.48228530254342,34.48443109621768,34.48858999847908,34.49106220386144,34.49288170277669,34.49412069674123,34.49392139706853,34.4912443018986,34.49045880428647,34.49025960149258,34.48934700209669,34.48908129855841,34.48620480205064,34.48463939616665,34.48444010378272,34.48372089878751,34.48345519815341,34.48234900232649,34.48195619585378,34.48065660073226,34.48026379859417,34.47909120147845,34.47889190062253,34.4779127967196,34.47706659779267,34.47504769671732,34.4740022040397,34.47308949751402,34.47204390230506,34.47054489904281,34.47041200191219,34.4691728989982,34.46813319543193,34.46585449969711,34.46480879647267,34.46356969829986,34.46213720159257,34.46050519815032,34.45816589984693]}]],[[{"lng":[-119.7898127967993,-119.7866898036361,-119.7861189036881,-119.7845166999301,-119.7819647012897,-119.7815712977921,-119.7823052046825,-119.7820748943275,-119.7827272004658,-119.7820148019019,-119.7822594014407,-119.7809089034298,-119.7794838979972,-119.7791718981243,-119.7779772000571,-119.7774276970069,-119.7765520983737,-119.7768781949074,-119.7760840977778,-119.775126795904,-119.7748148057936,-119.7750594016212,-119.7764988031118,-119.7780268961813,-119.7785978024588,-119.779317494893,-119.7800444014542,-119.782448399936,-119.7837320023483,-119.785653896414,-119.7858170003657,-119.7888522033893,-119.7896535983933,-119.790929997309,-119.7918872994302,-119.7930004965516,-119.7933939002363,-119.7949077979768,-119.7942549055129,-119.7943291997413,-119.7950416010972,-119.794077099134,-119.7935874959241,-119.7928604022892,-119.7935728007615,-119.7930906036245,-119.792356298249,-119.7916365942256,-119.7912213979179,-119.7939221954936,-119.7937590043747,-119.7927946014562,-119.7930321029338,-119.7924610020518,-119.7904580968171,-119.7898127967993],"lat":[34.49624589936079,34.49495809629598,34.4931386986275,34.49236480088693,34.49289629697117,34.4938089021383,34.49614819926524,34.49758069784983,34.49965999655913,34.50063909635736,34.50141890141472,34.50253079835124,34.50448889986841,34.50566140298836,34.50618709639176,34.50768589830397,34.50814510300525,34.5091847984347,34.50990390173796,34.51010319770673,34.51127570274303,34.51205539814526,34.51230960018871,34.51392979993837,34.51574920178769,34.51587619699214,34.51710939923411,34.51827029688688,34.51911060143474,34.51981800073376,34.52033780190129,34.52025960329961,34.5206465032492,34.52038070226959,34.52018129689785,34.51939560422048,34.51848300266521,34.517890700362,34.51581150163801,34.51496530306107,34.5139861966006,34.51307949638997,34.51152010020034,34.51028699609807,34.50930789721267,34.50885450256909,34.50651529719586,34.50638829747476,34.50398269740974,34.50175860027378,34.50123879782925,34.50033199807167,34.50000570141471,34.49818629847837,34.49721899892501,34.49624589936079]}]],[[{"lng":[-119.7641785992493,-119.7597135007802,-119.7583563997901,-119.7567684987991,-119.7552552015781,-119.75509910076,-119.7539047020242,-119.7532735997115,-119.7516787962073,-119.7503282005877,-119.7497784016896,-119.748509198451,-119.7483529972951,-119.7470770959079,-119.7460453959298,-119.7425365042316,-119.7418984998761,-119.7415111997495,-119.7401603966275,-119.7403297033402,-119.7380965996371,-119.7365893995987,-119.7357201024118,-119.7346068007791,-119.7332621022496,-119.7336689971392,-119.7327996949891,-119.7317676003056,-119.732574904609,-119.7320994981359,-119.7307482053703,-119.7321124038018,-119.7330889959702,-119.7336522983115,-119.7350915022705,-119.7360488000642,-119.7374131022964,-119.7400538977442,-119.7406172032804,-119.7422941976764,-119.7454852009696,-119.7462796020589,-119.7450780037402,-119.7448271058075,-119.7453838029586,-119.7472982956424,-119.748900396963,-119.7503396035416,-119.7522541006013,-119.7537680010273,-119.7542432953276,-119.7528788012102,-119.7527906012668,-119.7517318042471,-119.7512499040706,-119.7523632005111,-119.7529877972206,-119.7534628948858,-119.7532119002113,-119.7537685045225,-119.7534427025441,-119.754230101136,-119.7547866978452,-119.755017496209,-119.7562798966096,-119.7554790044086,-119.7546645973582,-119.7544135994607,-119.75600159564,-119.7588723018154,-119.7606976986793,-119.7618852016006,-119.764117797056,-119.765312103683,-119.7657055947878,-119.7649048034761,-119.7641785992493],"lat":[34.47084809747166,34.47177739682461,34.47178299654463,34.47322099708041,34.47381279745015,34.47439909981153,34.47492450303207,34.47616329592629,34.47649509721069,34.4776066993841,34.47910550366029,34.48047699805691,34.48106330267191,34.48132870051663,34.4823739000832,34.48310360055596,34.48323619601289,34.48525489923259,34.48636640336933,34.48799240199801,34.48845660127652,34.4901542995971,34.49171930162682,34.49250439790129,34.49472199949993,34.49602170425641,34.49758669895558,34.49863179959036,34.50012520247023,34.50077770060221,34.50188910173719,34.50298989732014,34.50610939852876,34.50682289808908,34.50707759674043,34.50687860156702,34.50797939941376,34.50881490053974,34.50952849732472,34.50945680050528,34.50879349678444,34.50807460271919,34.50749370200122,34.50560780251459,34.50521520018653,34.50481719809683,34.50559160186774,34.50584600159177,34.50544789887794,34.50485619997603,34.50420359882687,34.50310299707684,34.50173689870075,34.49835769749543,34.4979042024481,34.49711890105844,34.49477399998614,34.49412139899677,34.49223540072293,34.49184280101558,34.49080299741539,34.48897790017823,34.48858519841681,34.48715280344504,34.48467509750052,34.4842879018958,34.48168850307127,34.47980250017157,34.47836460144692,34.47776719628782,34.47600290216337,34.47437129730439,34.47390660171501,34.47338110306073,34.47246849824636,34.47208139896395,34.47084809747166]}]],[[{"lng":[-119.8103308951598,-119.806825200953,-119.8058766009858,-119.8054913036841,-119.8044609985238,-119.8025636053073,-119.8029713000224,-119.8023412997183,-119.8028304988055,-119.7999839996923,-119.7987089016976,-119.8003842945401,-119.8018966019179,-119.8032531965666,-119.8040538986955,-119.8050991982696,-119.8070117982794,-119.8071749982926,-119.8078125001873,-119.8078050026078,-119.8095468990401,-119.8099397014771,-119.8104065043007,-119.809345996023,-119.809894396178,-119.8094050024173,-119.8111466023479,-119.8115392961617,-119.8111313955902,-119.8103308951598],"lat":[34.42522809869018,34.42595969748341,34.42726550277989,34.429284403327,34.43033020007422,34.43294160273533,34.43424119875414,34.43548040102043,34.43704000025381,34.44095699718662,34.44122289617383,34.44115039799576,34.44055799953775,34.4405520000122,34.44093879896927,34.4421053968087,34.44170639970924,34.44222620131364,34.44209320370257,34.44098700197874,34.43896189978951,34.4380490998516,34.43629000295722,34.43291109930409,34.43141190121998,34.42985239802411,34.42782729662567,34.42691450311727,34.42561489723156,34.42522809869018]}]],[[{"lng":[-119.7670887052093,-119.7678825000712,-119.7713902018265,-119.7724212985726,-119.7740156995416,-119.7746464039695,-119.7763896002124,-119.7776651020743,-119.779719805384,-119.7815442969054,-119.781218299804,-119.7844065975656,-119.7852742989618,-119.7862308016972,-119.7871129957463,-119.7891889024358,-119.7898192946825,-119.7922736042681,-119.7916287037003,-119.7913768974188,-119.7907248046561,-119.79168109875,-119.7905398987668,-119.7893391003434,-119.7883012967766,-119.787812302476,-119.7881239025413,-119.7876348997121,-119.7861154035976,-119.7846103965897,-119.7847733034422,-119.7838242957173,-119.7793614964649,-119.7792056978868,-119.7768928004004,-119.7764996997406,-119.7754689028925,-119.7754759984558,-119.7747640019613,-119.7738076022302,-119.7741334956207,-119.7728582985121,-119.7714270994153,-119.7709594020164,-119.769847100887,-119.7704101963997,-119.770899000487,-119.7720998040335,-119.7725070957196,-119.772195304402,-119.7726026035655,-119.7720463968132,-119.7720533994095,-119.7710223967943,-119.7699168970295,-119.770005299394,-119.7673121999239,-119.767719500708,-119.7670887052093],"lat":[34.4638735016588,34.4631544038421,34.46242400040978,34.46137850197366,34.46104640345358,34.45980739851167,34.45778290030567,34.45751719763515,34.45431990287131,34.45255520122814,34.45151550060086,34.45085110184343,34.44928559611522,34.44908619919436,34.44973310114116,34.44985419788742,34.44861509872315,34.44561109961966,34.44463789593141,34.44275189842513,34.44067250276406,34.44047310247022,34.43683410421953,34.43625369782333,34.43619310286626,34.43463350205785,34.43346090169681,34.43190120163965,34.43138730152123,34.43308570022808,34.43360549790759,34.43491110013539,34.4358412001074,34.43642760115647,34.43663260307424,34.43754530052187,34.43859079572344,34.43969699836633,34.44067609998439,34.44087539876468,34.44191509951322,34.44218079734965,34.44303280146984,34.44479169702657,34.44557720327646,34.44629059666165,34.4478502979106,34.4484308027342,34.44973050142873,34.45090309804655,34.45220280249578,34.45259559769563,34.4537018004397,34.45474719750008,34.45663890044901,34.45800499994978,34.46133489702621,34.46263459696119,34.4638735016588]}]],[[{"lng":[-119.8300656980128,-119.8299103044174,-119.8283986005026,-119.8292808010977,-119.8295255966739,-119.8304815975075,-119.8316009004353,-119.8323198033091,-119.8319117018501,-119.830710800109,-119.8300656980128],"lat":[34.41778349873238,34.41836989977898,34.41896260295863,34.41960920042711,34.42038900048951,34.42018919880466,34.42050929662295,34.4206361016547,34.41933650192808,34.418756498702,34.41778349873238]}]]],null,".",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6,"smoothFactor":1,"noClip":false},["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10415&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400757&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td>14.13629405&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400757&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td>10.5621850&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>42.346351&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10416&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400760&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400761&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td>14.48325133&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400760&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td>10.7538978&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>14.483251&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10417&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400761&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 7.21395707&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400761&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 5.0737552&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>21.697208&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10418&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400762&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400763&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 8.73494443&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400762&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 9.0097767&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>16.579344&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10419&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400764&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400763&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 7.78275487&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400764&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td>10.3528777&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>13.181858&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10420&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400765&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400757&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 6.51284845&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400765&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 4.7609115&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 6.512848&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10421&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400768&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 5.24699921&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400768&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 4.9098462&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 5.246999&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>19000&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400759&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td>10.82834664&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400759&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 9.9484268&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>50.584493&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>29018&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400770&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400763&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 4.38659973&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400770&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 3.2876209&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 4.386600&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>29019&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400766&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400762&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 3.45780006&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400766&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 3.3811192&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 3.457800&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>29020&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400767&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400764&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 5.39910318&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400767&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 5.3821377&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 5.399103&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>29021&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400763&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 1.04850126&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400763&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 2.0755085&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>30.809704&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>29022&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400769&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400759&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 3.69944404&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400769&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 3.5423619&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 3.699444&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>29023&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400758&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-1000013828&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 0.05129986&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400758&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 0.2723448&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>92.982144&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.84,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-119.8691032011303,34.41778349873238,-119.7307482053703,34.5206465032492,true,".","Zoom to .","<strong> . <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],".",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["."],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"."}]}],"limits":{"lat":[34.41778349873238,34.5206465032492],"lng":[-119.8691032011303,-119.7307482053703]},"fitBounds":[34.41778349873238,-119.8691032011303,34.5206465032492,-119.7307482053703,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</div>
<div class="section level2">
<h2 id="subsetting">Subsetting!<a class="anchor" aria-label="anchor" href="#subsetting"></a>
</h2>
<p>Now, while conceptual that is straight forward, doing this
repetitively is annoying. Equally, writing out the logic for all layers
is a loop that can be prone to easy errors.</p>
<p>In these cases, we provide a subset_network function that works o
n</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">xx</span> <span class="op">=</span> <span class="fu"><a href="../reference/subset_network.html">subset_network</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">wbd</span><span class="op">$</span><span class="va">toid</span>, </span>
<span>                      lyrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"divides"</span>, <span class="st">"nexus"</span>, <span class="st">"flowpaths"</span>, <span class="st">"lakes"</span>, <span class="st">"flowpath_attributes"</span><span class="op">)</span>,</span>
<span>                      cache_dir <span class="op">=</span> <span class="st">"cihro-data"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: There was 1 warning in `filter()`.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> In argument: `hf_id == comid`.</span></span>
<span><span class="co">## Caused by warning in `hf_id == comid`:</span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> longer object length is not a multiple of shorter object length</span></span></code></pre>
<pre><code><span><span class="co">## Starting from: `wb-3400757`</span></span></code></pre>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   4.755   0.684   8.711</span></span></code></pre>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-872036b94f76f98cf9a0" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-872036b94f76f98cf9a0">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-119.8259698018833,-119.8240731948911,-119.8234358018784,-119.8223319024754,-119.8209092983338,-119.8193234022452,-119.8194865984885,-119.8173524008228,-119.8167149018791,-119.815847904418,-119.8144989976902,-119.8125124039352,-119.8080497014035,-119.8078125001873,-119.8078050026078,-119.8095468990401,-119.8099397014771,-119.811214705801,-119.812015302085,-119.8132902990473,-119.8147948999693,-119.8178775992777,-119.8184335022975,-119.818344197495,-119.817609901795,-119.8189585977797,-119.8208707972831,-119.8213526985205,-119.8235835017674,-119.824768900694,-119.8248427984281,-119.8257988019095,-119.8265099975326,-119.8282588003588,-119.8283325973729,-119.8295255966739,-119.8304815975075,-119.8316009004353,-119.8323198033091,-119.8329570959987,-119.8334470001868,-119.8339289007428,-119.8358409014798,-119.8396808033612,-119.8401706994324,-119.8408897039107,-119.8420988031545,-119.8405950000354,-119.8402842999805,-119.8406110006691,-119.8397445973858,-119.8408063045954,-119.8415253988181,-119.8421708008538,-119.8422524968411,-119.8422605024601,-119.8427506992609,-119.8422766031327,-119.8426849981409,-119.8441232981427,-119.8443684020503,-119.8463706001829,-119.8467792018534,-119.8474984041786,-119.8487241015858,-119.8494432990874,-119.849851903806,-119.8510534047857,-119.8520097003802,-119.8532928970144,-119.8546497017749,-119.8554508047459,-119.8570856967384,-119.8563745960327,-119.8563827961659,-119.8556799009062,-119.8548052027081,-119.8552956964816,-119.8549115048903,-119.8519603011204,-119.8519685030297,-119.8500635986251,-119.8498346000758,-119.8491969032291,-119.8492049974372,-119.8496874047804,-119.851240601121,-119.8506845992135,-119.8512486957659,-119.8504636972649,-119.8491962963622,-119.84920440371,-119.8470538967092,-119.8474625998383,-119.8477239984956,-119.8491712995484,-119.8494246999391,-119.8487213017609,-119.8484266966037,-119.8490726979899,-119.8501114039819,-119.8510764011425,-119.8517305985314,-119.8509372991377,-119.8513380026877,-119.8522294980916,-119.8497594011504,-119.8474447042191,-119.846324203236,-119.8456701006773,-119.8443043958364,-119.8424722952284,-119.8386444028323,-119.8373604953698,-119.8344896998816,-119.8336144027161,-119.8321750051178,-119.8310546016911,-119.8304904953801,-119.8292883997755,-119.8278489963119,-119.8266470031082,-119.8255266032083,-119.824561897044,-119.8236634008122,-119.8237295033682,-119.822994401367,-119.8244997982833,-119.8254565993583,-119.8264057040583,-119.8273624953874,-119.8285487000342,-119.8278136014778,-119.8275606983558,-119.8285096032625,-119.8288207017067,-119.8295324025166,-119.8320756954314,-119.8336701046247,-119.835011498186,-119.8368430994549,-119.8373174036044,-119.8389934972287,-119.8394678011033,-119.8407431969547,-119.8411357975525,-119.8417734960145,-119.8427139967158,-119.8427059987281,-119.8431802970943,-119.842608298022,-119.8412431982206,-119.8405895956536,-119.8413008995474,-119.8410558030532,-119.8412031971081,-119.8423150013288,-119.8418247990127,-119.8411055026356,-119.8398800991411,-119.8386786968511,-119.8376328008763,-119.8368976994035,-119.8362522024888,-119.8368080994613,-119.8350930011255,-119.8349217955357,-119.8341209988313,-119.8326748991908,-119.8315554004074,-119.8309179963904,-119.8302883968972,-119.8290213024398,-119.8274274960797,-119.8263974976034,-119.825122499315,-119.8250486052253,-119.8214915013784,-119.8208540018466,-119.8202241014225,-119.8187933998417,-119.8181404972157,-119.818696402824,-119.8185255013865,-119.8197113043916,-119.8194665043493,-119.8211264978285,-119.8202364013058,-119.8210293944704,-119.8210217015363,-119.8215775978596,-119.8212512037261,-119.8232297041127,-119.8233852033907,-119.8250603009815,-119.8277498967146,-119.8285349033279,-119.8283716998111,-119.8293198969771,-119.8291567008964,-119.8302602981149,-119.8298520988114,-119.8288961019337,-119.8265255995537,-119.8259698018833],"lat":[34.42528610012504,34.42789789775298,34.42803100227203,34.42992319815421,34.43188199793501,34.43332090236119,34.43384079749269,34.43677880080526,34.4369118965753,34.43847759842219,34.43959000344571,34.44083550315078,34.44176670072316,34.44209320370257,34.44098700197874,34.43896189978951,34.4380490998516,34.43778300285349,34.43816979768673,34.43790370340687,34.43620490031654,34.43196110285961,34.4315680968765,34.43020200077927,34.42786279592889,34.42675029864022,34.42635099847006,34.4268043014121,34.42633839718682,34.42470609604721,34.42385980124907,34.42366009955231,34.42268070020698,34.42176149800731,34.42091520229241,34.42038900048951,34.42018919880466,34.42050929662295,34.4206361016547,34.42050290261517,34.42206230376929,34.42251560012433,34.42211599775585,34.42352930044288,34.42508870181777,34.42521540232672,34.42690149938338,34.42860060282884,34.42977339829413,34.43081300061266,34.4323788988251,34.43575760250587,34.43588419996917,34.43685719804876,34.43711710412683,34.43822329671313,34.43978270292422,34.44043570064171,34.44173509758138,34.44198849741548,34.44276820271642,34.44373449802319,34.44503400002061,34.44516059825639,34.4490589988592,34.44918560229686,34.45048500178914,34.45106480223539,34.45086490337925,34.45170449952679,34.45169789784962,34.45208439905579,34.45728199850851,34.45826149830626,34.45936769813258,34.46145339611231,34.46191319709932,34.46347249678243,34.46549150154497,34.4658313999963,34.46693750235315,34.46844340267387,34.4698761016645,34.47000929966188,34.47111550265762,34.4715686022518,34.47650630154421,34.47689939848794,34.47761240260611,34.47943820300892,34.48081080356342,34.48191699867073,34.48264319805482,34.4839425971961,34.48693439714036,34.48829380113485,34.4901796000309,34.49226519823304,34.49565009705668,34.49662300375434,34.49668300238756,34.49758929688686,34.49966820115185,34.50038780394264,34.50058109671208,34.50233350000507,34.50312639959369,34.50333290099673,34.50301299722817,34.50093400039938,34.49983439992302,34.50049399827418,34.50129309872489,34.50045339901256,34.50105259894195,34.50151230026382,34.50125880182978,34.50093869986296,34.50022569722204,34.4996456979108,34.49939219851823,34.49881219843714,34.49849209544253,34.49758569787834,34.49472689808398,34.49277450076274,34.49043550028489,34.48873670182007,34.48853710179861,34.48723130296369,34.48703160100865,34.48539930144933,34.48306030346517,34.48117450307861,34.47986869990243,34.47869599947423,34.47771660261012,34.47607789926575,34.47574499857343,34.47352629641845,34.47286690389432,34.4722139020644,34.47214080432988,34.47148789656303,34.47122149877828,34.47030860225635,34.47017540161387,34.46776329923158,34.4666571988834,34.46600420134623,34.46418500062983,34.46308530288468,34.46100620201079,34.46002679780228,34.45924710335544,34.4575545993213,34.45676840340386,34.45520899812012,34.45508230197013,34.45118399665709,34.45060410251845,34.44943779575708,34.44709869829975,34.44612579806175,34.44573269726995,34.44027479595007,34.43864879979049,34.43826219610871,34.43690260137969,34.43658250216981,34.43671560310509,34.43795499982529,34.43932739975563,34.43966030217926,34.44070629912492,34.44097250274743,34.44181880236481,34.44671570274234,34.4468487958576,34.44808810249901,34.4489405979965,34.44686130048253,34.44646829657989,34.44484230176831,34.44321010060497,34.44243029871197,34.44014519754814,34.43839230288852,34.43767289855622,34.43656670183903,34.43617370453528,34.4351339983692,34.43278229860869,34.43219590247939,34.43212299842864,34.42879169869808,34.42696599755936,34.42644620253393,34.4251402988716,34.42462040229069,34.42272810113772,34.42142859748505,34.42162829796185,34.42489309748074,34.42528610012504]}]],[[{"lng":[-119.8257327972145,-119.8246944990448,-119.8244495024143,-119.8228473975655,-119.8229213035378,-119.8216966012984,-119.8213777987895,-119.8205613956902,-119.8201531960846,-119.8209464029125,-119.8199745021984,-119.8206861046088,-119.8201963042245,-119.8212267039466,-119.8209817984248,-119.8198620950212,-119.8192908013226,-119.8192831053539,-119.8183189979637,-119.8187933998417,-119.8202241014225,-119.8208540018466,-119.8214915013784,-119.8250486052253,-119.825122499315,-119.8263974976034,-119.8274274960797,-119.8290213024398,-119.8302883968972,-119.8309179963904,-119.8315554004074,-119.8326748991908,-119.8341209988313,-119.8349217955357,-119.8350930011255,-119.8368080994613,-119.8362522024888,-119.8368976994035,-119.8376328008763,-119.8386786968511,-119.8398800991411,-119.8411055026356,-119.8418247990127,-119.8423150013288,-119.8412031971081,-119.8410558030532,-119.8413008995474,-119.8405895956536,-119.8412431982206,-119.842608298022,-119.8431802970943,-119.8427059987281,-119.8427139967158,-119.8417734960145,-119.8411357975525,-119.8407431969547,-119.8394678011033,-119.8389934972287,-119.8373174036044,-119.8368430994549,-119.835011498186,-119.8336701046247,-119.8320756954314,-119.8295324025166,-119.8288207017067,-119.8285096032625,-119.8275606983558,-119.8268411983974,-119.8260982990574,-119.8269733997827,-119.8272845009717,-119.8281594972311,-119.827914402597,-119.8282255014336,-119.8267049952378,-119.8257327972145],"lat":[34.4710322991247,34.4709719974844,34.47019240106985,34.46941899984394,34.46857270330636,34.46467420100562,34.46474079686971,34.46214179864607,34.46084220281713,34.46012279626798,34.45811010311055,34.45713079967118,34.45557130231993,34.45452540292552,34.45374570053178,34.45342549721812,34.4516062004389,34.45050000199185,34.44959350132201,34.4489405979965,34.44808810249901,34.4468487958576,34.44671570274234,34.44181880236481,34.44097250274743,34.44070629912492,34.43966030217926,34.43932739975563,34.43795499982529,34.43671560310509,34.43658250216981,34.43690260137969,34.43826219610871,34.43864879979049,34.44027479595007,34.44573269726995,34.44612579806175,34.44709869829975,34.44943779575708,34.45060410251845,34.45118399665709,34.45508230197013,34.45520899812012,34.45676840340386,34.4575545993213,34.45924710335544,34.46002679780228,34.46100620201079,34.46308530288468,34.46418500062983,34.46600420134623,34.4666571988834,34.46776329923158,34.47017540161387,34.47030860225635,34.47122149877828,34.47148789656303,34.47214080432988,34.4722139020644,34.47286690389432,34.47352629641845,34.47574499857343,34.47607789926575,34.47771660261012,34.47869599947423,34.47986869990243,34.48117450307861,34.48104770310494,34.47760259769093,34.47714300059824,34.47597030260573,34.47551070393086,34.47473099610114,34.47355829616077,34.47304490081351,34.4710322991247]}]]],null,"xx$divides",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6,"smoothFactor":1,"noClip":false},["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10415&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400757&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td>14.136294&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400757&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td>10.562185&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>42.346351&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>10420&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><tr><td>3<\/td><th>divide_id&emsp;<\/th><td>cat-3400765&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400757&emsp;<\/td><\/tr><tr><td>5<\/td><th>type&emsp;<\/th><td>network&emsp;<\/td><\/tr><tr><td>6<\/td><th>ds_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>areasqkm&emsp;<\/th><td> 6.512848&emsp;<\/td><\/tr><tr><td>8<\/td><th>id&emsp;<\/th><td>wb-3400765&emsp;<\/td><\/tr><tr><td>9<\/td><th>lengthkm&emsp;<\/th><td> 4.760911&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 6.512848&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_flowline&emsp;<\/th><td>1&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.84,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-119.8570856967384,34.42018919880466,-119.8078050026078,34.50333290099673,true,"xx$divides","Zoom to xx$divides","<strong> xx$divides <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["xx$divides"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"xx$divides"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[34.43619061321491,34.42014561323981],[-119.8323065911028,-119.8295779244405],6,null,"xx$nexus",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>12942&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>3<\/td><th>id&emsp;<\/th><td>nex-3400757&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>wb-3400757&emsp;<\/td><\/tr><tr><td>5<\/td><th>hl_id&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>6<\/td><th>hl_uri&emsp;<\/th><td>NA&emsp;<\/td><\/tr><tr><td>7<\/td><th>type&emsp;<\/th><td>nexus&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>12943&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><tr><td>3<\/td><th>id&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>wb-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>hl_id&emsp;<\/th><td>2281&emsp;<\/td><\/tr><tr><td>6<\/td><th>hl_uri&emsp;<\/th><td>HUC12-180600130201,Gages-11120000&emsp;<\/td><\/tr><tr><td>7<\/td><th>type&emsp;<\/th><td>poi&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addHomeButton","args":[-119.8323065911028,34.42014561323981,-119.8295779244405,34.43619061321491,true,"xx$nexus","Zoom to xx$nexus","<strong> xx$nexus <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["xx$nexus"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"xx$nexus"}]},{"method":"createMapPane","args":["line",430]},{"method":"addPolylines","args":[[[[{"lng":[-119.8305149762557,-119.8297177244403,-119.8284465244423,-119.8277555244433,-119.8268159911114,-119.8260145244461,-119.8257657911131,-119.8256829911132,-119.8255173911135,-119.8253241244471,-119.8254625911135,-119.8259051244462,-119.8267899244449,-119.8271493244442,-119.8276745911101,-119.8279787911096,-119.8285315244422,-119.8290565911081,-119.8295267244407,-119.8298583911068,-119.8301349911064,-119.8307433244388,-119.8309923911051,-119.8308817911051,-119.8304397244392,-119.8300807244398,-119.8299979244399,-119.8298599911067,-119.8296113911071,-119.8295287244407,-119.8297499244403,-119.8305241244391,-119.8306901244388,-119.8307731911054,-119.8309391244384,-119.8317129911039,-119.8320169911034,-119.8324317911028,-119.8334819911012,-119.8338691244338,-119.8341177911002,-119.8348641244323,-119.8352509910984,-119.8360801244305,-119.8365775244297,-119.8371301910954,-119.8372131910954,-119.8372687244286,-119.8373793244284,-119.8378491244277,-119.8393139910921,-119.8399221910912,-119.8412211244225,-119.8416909910884,-119.8418569244215,-119.8419399244214,-119.8422991910875,-119.8431561244194,-119.8435431244188,-119.8437089910853,-119.8443999244175,-119.8444553910841,-119.8448699244168,-119.8447871244169,-119.8448149244169,-119.8458375244152,-119.8458651910819,-119.8456165244157,-119.8445941910839,-119.8444837910841,-119.8444839244174,-119.8445667910839,-119.8446223244172,-119.8451475244164,-119.8453133910828,-119.8452307244162,-119.844705924417,-119.8446783244171,-119.8449269910833,-119.8448995244168,-119.8446231910838,-119.8439877910848,-119.843877391085,-119.842551391087,-119.8424133910872,-119.8423857910874,-119.8426069244204,-119.842109924421,-119.8409221244229,-119.840839324423,-119.8405079244236,-119.8400383910909,-119.8392095910922,-119.8390441244258,-119.8392373910922,-119.8392377244255,-119.838657991093,-119.8378295244277,-119.8378023244278,-119.8372501244286,-119.8371814508788,-119.8369191910958,-119.836698391096,-119.8359525910973,-119.8332179911014,-119.8323065911028,-119.831699191104,-119.8312573911046,-119.8309539244384,-119.8309841244383,-119.830957991105,-119.8307647244387,-119.8300745244398,-119.8295223244406,-119.8295779244405],"lat":[34.49661599638681,34.49542287978968,34.49446127979111,34.49416361312483,34.49324787979295,34.49295027979345,34.49272141312714,34.49251527979423,34.49162267979553,34.49123347979616,34.49036381313091,34.48972307979854,34.48924267979933,34.48887661313304,34.48812141313437,34.48803001313441,34.48825881313396,34.48823607980073,34.48796161313447,34.48761841313498,34.48706907980265,34.48649701313688,34.48546721313842,34.48519247980533,34.48473467980627,34.48372747980783,34.4836818131411,34.48265181314282,34.48217101314354,34.48171327981085,34.48120981314499,34.4802716131466,34.47988247981369,34.47924167981468,34.47894427981515,34.47871561314892,34.47839521314942,34.47816627981648,34.47784607981698,34.47738841315105,34.47727401315115,34.47715981315132,34.47725141315126,34.47748041315076,34.47743467981759,34.47727467981783,34.47697701315158,34.47626747981921,34.47603867981972,34.47574121315346,34.47537527982072,34.47459721315526,34.47404801315618,34.47375047982329,34.47338441315717,34.47297241315781,34.47233161315877,34.4716222131599,34.47095847982762,34.47031761316192,34.46944801316333,34.46841807983146,34.46802907983214,34.46727381316655,34.46697627983365,34.46574047983569,34.46519107983644,34.46445867983767,34.46358887983907,34.46331421317277,34.46294801317336,34.46271907984048,34.46148327984235,34.46045341317724,34.459972813178,34.4584164131805,34.45740927984852,34.45692867984926,34.45658547984988,34.4561276798505,34.45566987985135,34.45537227985187,34.45452541318652,34.4534266798547,34.45315207985517,34.45276287985583,34.45193887985709,34.45093181319197,34.44976441319384,34.44948981319418,34.44898621319501,34.44857421319572,34.44811621319634,34.44752121319723,34.44717787986446,34.44628527986586,34.44447707986874,34.44292061320455,34.4417076132063,34.44054021320815,34.44007949995365,34.43832001321161,34.43781647987895,34.43735861321312,34.43667141321418,34.43619061321491,34.4355496132159,34.43490861321698,34.43408447988495,34.42676061322954,34.42252621323608,34.4220226799035,34.42149607990437,34.42090087990523,34.42014561323981]}]],[[{"lng":[-119.8300119494879,-119.8301389911064,-119.830996191105,-119.8312175911047,-119.8312177244379,-119.8310521911048,-119.830362391106,-119.8300585244398,-119.8295889911071,-119.8294509244407,-119.8294235244408,-119.8299209911066,-119.8299487911066,-119.829700391107,-119.8295623911072,-119.8296177911071,-119.8300879244397,-119.8313315911045,-119.8315803911041,-119.831635791104,-119.831635991104,-119.8318849244369,-119.8326589244357,-119.8329351244353,-119.8334603911012,-119.8334881911011,-119.8332671911014,-119.8332121244349,-119.8327149244357,-119.8321073244366,-119.8320521911034,-119.8322733911029,-119.8336825911008,-119.8340693244335,-119.8343733910997,-119.8343735910998,-119.8342079244334,-119.8336279911009,-119.8334637911012,-119.8333813244346,-119.8334643911012,-119.8338789911005,-119.8339895911004,-119.8340173911002,-119.8337139244341,-119.8330789244351,-119.8328585244354,-119.8326655244358,-119.8323341911029,-119.8323065911028],"lat":[34.47507754910137,34.47470981315509,34.47322227982416,34.47214667982575,34.47136847982686,34.47040721316172,34.46770627983262,34.4669738131672,34.46651601316785,34.4661726131684,34.46566907983583,34.46511987983659,34.4647536798372,34.46413567983807,34.46363207983887,34.4630142131733,34.46214461317462,34.46109201317632,34.46070301317679,34.46029101317755,34.45985607984476,34.45921541317911,34.45804827984762,34.45795681318098,34.45711001318241,34.4567208798497,34.45640047985016,34.4561258131839,34.45564507985127,34.45466067985295,34.45429447985341,34.45390561318737,34.45369981318761,34.45356261318798,34.45303627985531,34.45225807985666,34.45193767985715,34.45120507985819,34.44578067986665,34.44456767986853,34.44415567986915,34.44360647987,34.44328607987056,34.44255367987179,34.44129467987364,34.44012727987543,34.43818187987844,34.43717481321333,34.4364652132145,34.43619061321491]}]]],null,"xx$flowpaths",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"line","stroke":true,"color":"#6666FF","weight":2,"opacity":0.9,"fill":false,"fillColor":"#6666FF","fillOpacity":1,"smoothFactor":1,"noClip":false},["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>13848&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTILINESTRING&emsp;<\/td><\/tr><tr><td>3<\/td><th>id&emsp;<\/th><td>wb-3400757&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400758&emsp;<\/td><\/tr><tr><td>5<\/td><th>mainstem&emsp;<\/th><td>1841917&emsp;<\/td><\/tr><tr><td>6<\/td><th>order&emsp;<\/th><td>2&emsp;<\/td><\/tr><tr><td>7<\/td><th>hydroseq&emsp;<\/th><td>16722&emsp;<\/td><\/tr><tr><td>8<\/td><th>lengthkm&emsp;<\/th><td>10.562185&emsp;<\/td><\/tr><tr><td>9<\/td><th>areasqkm&emsp;<\/th><td>14.136294&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td>42.346351&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_divide&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>12<\/td><th>divide_id&emsp;<\/th><td>cat-3400757&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>fid&emsp;<\/th><td>13854&emsp;<\/td><\/tr><tr><td>2<\/td><th>geom&emsp;<\/th><td>sfc_MULTILINESTRING&emsp;<\/td><\/tr><tr><td>3<\/td><th>id&emsp;<\/th><td>wb-3400765&emsp;<\/td><\/tr><tr><td>4<\/td><th>toid&emsp;<\/th><td>nex-3400757&emsp;<\/td><\/tr><tr><td>5<\/td><th>mainstem&emsp;<\/th><td>1841933&emsp;<\/td><\/tr><tr><td>6<\/td><th>order&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>7<\/td><th>hydroseq&emsp;<\/th><td>16721&emsp;<\/td><\/tr><tr><td>8<\/td><th>lengthkm&emsp;<\/th><td> 4.760911&emsp;<\/td><\/tr><tr><td>9<\/td><th>areasqkm&emsp;<\/th><td> 6.512848&emsp;<\/td><\/tr><tr><td>10<\/td><th>tot_drainage_areasqkm&emsp;<\/th><td> 6.512848&emsp;<\/td><\/tr><tr><td>11<\/td><th>has_divide&emsp;<\/th><td>1&emsp;<\/td><\/tr><tr><td>12<\/td><th>divide_id&emsp;<\/th><td>cat-3400765&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":3,"opacity":1,"fill":false,"fillOpacity":0,"bringToFront":false,"sendToBack":false}]},{"method":"addHomeButton","args":[-119.8458651910819,34.42014561323981,-119.8253241244471,34.49661599638681,true,"xx$flowpaths","Zoom to xx$flowpaths","<strong> xx$flowpaths <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],["xx$divides","xx$nexus","xx$flowpaths"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["xx$flowpaths"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"xx$flowpaths"}]},{"method":"addHomeButton","args":[-119.8570856967384,34.42014561323981,-119.8078050026078,34.50333290099673,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]}],"limits":{"lat":[34.42018919880466,34.50333290099673],"lng":[-119.8570856967384,-119.8078050026078]},"fitBounds":[34.42014561323981,-119.8570856967384,34.50333290099673,-119.8078050026078,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xx</span>, <span class="va">names</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $divides</span></span>
<span><span class="co">##  [1] "fid"                   "geom"                  "divide_id"            </span></span>
<span><span class="co">##  [4] "toid"                  "type"                  "ds_id"                </span></span>
<span><span class="co">##  [7] "areasqkm"              "id"                    "lengthkm"             </span></span>
<span><span class="co">## [10] "tot_drainage_areasqkm" "has_flowline"         </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nexus</span></span>
<span><span class="co">## [1] "fid"    "geom"   "id"     "toid"   "hl_id"  "hl_uri" "type"  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $flowpaths</span></span>
<span><span class="co">##  [1] "fid"                   "geom"                  "id"                   </span></span>
<span><span class="co">##  [4] "toid"                  "mainstem"              "order"                </span></span>
<span><span class="co">##  [7] "hydroseq"              "lengthkm"              "areasqkm"             </span></span>
<span><span class="co">## [10] "tot_drainage_areasqkm" "has_divide"            "divide_id"            </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lakes</span></span>
<span><span class="co">##  [1] "fid"          "geom"         "id"           "toid"         "hl_id"       </span></span>
<span><span class="co">##  [6] "hl_reference" "hl_link"      "hl_uri"       "Dam_Length"   "ifd"         </span></span>
<span><span class="co">## [11] "LkArea"       "LkMxE"        "OrificeA"     "OrificeC"     "OrificeE"    </span></span>
<span><span class="co">## [16] "time"         "WeirC"        "WeirE"        "WeirL"       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $flowpath_attributes</span></span>
<span><span class="co">##  [1] "fid"                  "id"                   "rl_gages"            </span></span>
<span><span class="co">##  [4] "rl_NHDWaterbodyComID" "Qi"                   "MusK"                </span></span>
<span><span class="co">##  [7] "MusX"                 "n"                    "So"                  </span></span>
<span><span class="co">## [10] "ChSlp"                "BtmWdth"              "time"                </span></span>
<span><span class="co">## [13] "Kchan"                "nCC"                  "TopWdthCC"           </span></span>
<span><span class="co">## [16] "TopWdth"              "length_m"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="example-for-poudre-river">Example for Poudre River!<a class="anchor" aria-label="anchor" href="#example-for-poudre-river"></a>
</h2>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">xx</span> <span class="op">=</span> <span class="fu"><a href="../reference/subset_network.html">subset_network</a></span><span class="op">(</span>hl_uri <span class="op">=</span> <span class="st">'Gages-06752260'</span>, </span>
<span>                      lyrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"divides"</span>, <span class="st">"nexus"</span>, <span class="st">"flowpaths"</span><span class="op">)</span>,</span>
<span>                      cache_dir <span class="op">=</span> <span class="st">"cihro-data"</span>,</span>
<span>                      outfile <span class="op">=</span> <span class="st">"cihro-data/poudre-subset.gpkg"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Starting from: `nex-278699`</span></span></code></pre>
<pre><code><span><span class="co">## Deleting layer `layer_styles' using driver `GPKG'</span></span></code></pre>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   3.783   1.319  12.723</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">st_layers</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Driver: GPKG </span></span>
<span><span class="co">## Available layers:</span></span>
<span><span class="co">##     layer_name     geometry_type features fields             crs_name</span></span>
<span><span class="co">## 1      divides     Multi Polygon      419      9 NAD83 / Conus Albers</span></span>
<span><span class="co">## 2        nexus             Point      171      5 NAD83 / Conus Albers</span></span>
<span><span class="co">## 3    flowpaths Multi Line String      419     10 NAD83 / Conus Albers</span></span>
<span><span class="co">## 4 layer_styles                NA        3     12                 &lt;NA&gt;</span></span></code></pre>
<div class="section level3">
<h3 id="open-in-qgis">Open in QGIS<a class="anchor" aria-label="anchor" href="#open-in-qgis"></a>
</h3>
<p><img src="../reference/figures/hydrofabric.png" width="642"></p>
</div>
</div>
<div class="section level2">
<h2 id="cli-option">CLI Option<a class="anchor" aria-label="anchor" href="#cli-option"></a>
</h2>
<p>For those interested in using the NOAA NextGen fabric as is, we have
provided a Go-based CLI <a href="https://github.com/LynkerIntel/hfsubset/releases" class="external-link">here</a></p>
<p>This utility has the following syntax:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="ex">hfsubset</span> <span class="at">-</span> Hydrofabric Subsetter</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="ex">Usage:</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="ex">hfsubset</span> <span class="pp">[</span><span class="ss">OPTIONS</span><span class="pp">]</span> identifiers...</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="ex">hfsubset</span> <span class="er">(</span><span class="ex">-h</span> <span class="kw">|</span> <span class="ex">--help</span><span class="kw">)</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a><span class="ex">Example:</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="ex">hfsubset</span> <span class="at">-l</span> divides <span class="at">-o</span> ./poudre-divides.gpkg <span class="at">-r</span> <span class="st">"pre-release"</span> <span class="at">-t</span> hl <span class="st">"Gages-06752260"</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  <span class="ex">hfsubset</span> <span class="at">-o</span> ./poudre-all.gpkg <span class="at">-t</span> hl <span class="st">"Gages-06752260"</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a><span class="ex">Options:</span></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  <span class="ex">-l</span> string</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>        <span class="ex">Layers</span> to subset <span class="er">(</span><span class="ex">default</span> <span class="st">"divides,nexus,flowpaths,network,hydrolocations"</span><span class="kw">)</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="ex">-o</span> string</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>        <span class="ex">Output</span> file name <span class="er">(</span><span class="ex">default</span> <span class="st">"hydrofabric.gpkg"</span><span class="kw">)</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  <span class="ex">-r</span> string</span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>        <span class="ex">Hydrofabric</span> version <span class="er">(</span><span class="ex">default</span> <span class="st">"pre-release"</span><span class="kw">)</span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  <span class="ex">-t</span> string</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>        <span class="ex">One</span> of: hf, hl, or comid <span class="er">(</span><span class="ex">default</span> <span class="st">"hf"</span><span class="kw">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="nextgen-needs-geojson-final-example">NextGen Needs GeoJSON: Final example<a class="anchor" aria-label="anchor" href="#nextgen-needs-geojson-final-example"></a>
</h3>
<p>While GPKG support is the end goal for NextGen, it current requires
GeoJSON and CSV inputs.</p>
<p>Fortunately, <code>ogr2ogr</code> provides easy ways to extract these
sub layer/formats from the GPKG file.</p>
<p>Here is a full-stop example of extracting a subset for a
hydrolocation, using the CLI, and generating the needed files for
NextGen</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="bu">cd</span> <span class="op">&lt;</span>WHEREVER YOU WANT!<span class="op">&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">mkdir</span> poudre</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a><span class="bu">cd</span> poudre</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a><span class="ex">hfsubset</span> <span class="at">-l</span> divides,nexus,flowpath_attributes <span class="at">-o</span> ./poudre-subset.gpkg <span class="at">-r</span> <span class="st">"pre-release"</span> <span class="at">-t</span> hl <span class="st">"Gages-06752260"</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a><span class="ex">ogr2ogr</span> <span class="at">-f</span> GeoJSON flowpath.geojson poudre-subset.gpkg flowpath</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a><span class="ex">ogr2ogr</span> <span class="at">-f</span> GeoJSON catchments.geojson poudre-subset.gpkg divides  </span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a><span class="ex">ogr2ogr</span> <span class="at">-f</span> GeoJSON nexus.geojson poudre-subset.gpkg nexus</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="ex">ogr2ogr</span> <span class="at">-f</span> CSV flowpath_attributes.csv poudre-subset.gpkg flowpath_attributes</span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a><span class="fu">ls</span> poudre</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mike Johnson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
